/**
 * jQuery Calx 2.2.7
 *
 * author       : Xsanisty Developer Team <developers@xsanisty.com>
 *                Ikhsan Agustian <ikhsan017@gmail.com>
 * website      : http://www.xsanisty.com/project/calx2
 * repository   : https://github.com/xsanisty/jquery-calx
 * license      : MIT
 */
"undefined"==typeof Zepto&&(Zepto=void 0),"undefined"==typeof jQuery&&(jQuery=Zepto),"undefined"==typeof numeral&&(numeral=void 0),"undefined"==typeof moment&&(moment=void 0),"undefined"==typeof jStat&&(jStat=void 0),function($,numeral,moment,jStat){if(void 0===$)return!1;"function"!=typeof Array.indexOf&&(Array.prototype.indexOf=function(t,e){for(var n=e||0;n<this.length;n++)if(this[n]==t)return n;return-1}),"function"!=typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"==typeof"test".__proto__?function(t){return t.__proto__}:function(t){return t.constructor.prototype});var defaultConfig={autoCalculate:!0,autoCalculateTrigger:"blur",onBeforeCalculate:null,onAfterCalculate:null,onBeforeRender:null,onAfterRender:null,defaultFormat:!1,ajaxUrl:null,ajaxMethod:"get",graphHandler:"flot",checkCircularReference:!1,data:{}};function parserFactory(t){var e={trace:function(){},yy:{},symbols_:{error:2,expressions:3,e:4,EOF:5,variableSequence:6,TRUE:7,FALSE:8,NULL:9,TIME_AMPM:10,TIME_24:11,number:12,STRING:13,"&":14,"=":15,"+":16,"(":17,")":18,"[":19,expseq:20,"]":21,"<":22,">":23,NOT:24,"-":25,"*":26,"/":27,"^":28,E:29,FUNCTION:30,cell:31,FIXEDCELL:32,":":33,CELL:34,SHEET:35,"!":36,RANGE:37,";":38,",":39,VARIABLE:40,DECIMAL:41,NUMBER:42,"%":43,"#":44,$accept:0,$end:1},terminals_:{5:"EOF",7:"TRUE",8:"FALSE",9:"NULL",10:"TIME_AMPM",11:"TIME_24",13:"STRING",14:"&",15:"=",16:"+",17:"(",18:")",19:"[",21:"]",22:"<",23:">",24:"NOT",25:"-",26:"*",27:"/",28:"^",29:"E",30:"FUNCTION",32:"FIXEDCELL",33:":",34:"CELL",35:"SHEET",36:"!",37:"RANGE",38:";",39:",",40:"VARIABLE",41:"DECIMAL",42:"NUMBER",43:"%",44:"#"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,1],[4,3],[4,4],[4,1],[4,1],[4,2],[31,1],[31,3],[31,1],[31,3],[31,3],[31,5],[31,1],[31,3],[20,1],[20,3],[20,3],[6,1],[6,3],[12,1],[12,3],[12,2],[2,3],[2,4]],performAction:function(e,n,r,i,a,o,l){var u=o.length-1;switch(a){case 1:return o[u-1];case 2:this.$=t.getVariable(o[u]);break;case 3:this.$=!0;break;case 4:this.$=!1;break;case 5:this.$=null;break;case 6:case 7:this.$=t.time(o[u]);break;case 8:this.$=1*o[u],isNaN(this.$)&&(this.$=0);break;case 9:this.$=o[u].substring(1,o[u].length-1);break;case 10:this.$=""+o[u-2]+o[u];break;case 11:this.$=t.comparator.equal.call(t,o[u-2],o[u]);break;case 12:this.$=formula.math.SUM.call(t,o[u-2],o[u]);break;case 13:this.$=1*o[u-1];break;case 14:this.$=o[u-1];break;case 15:this.$=t.comparator.lessEqual.call(t,o[u-3],o[u]);break;case 16:this.$=t.comparator.greaterEqual.call(t,o[u-3],o[u]);break;case 17:this.$=t.comparator.notEqual.call(t,o[u-3],o[u]);break;case 18:this.$=o[u-2]!=o[u];break;case 19:this.$=t.comparator.greater.call(t,o[u-2],o[u]);break;case 20:this.$=t.comparator.less.call(t,o[u-2],o[u]);break;case 21:this.$=formula.math.SUBTRACT.call(t,o[u-2],o[u]);break;case 22:this.$=formula.math.MULTIPLY.call(t,o[u-2],o[u]);break;case 23:this.$=formula.math.DIVIDE.call(t,o[u-2],o[u]);break;case 24:this.$=formula.math.POWER.call(t,o[u-2],o[u]);break;case 25:this.$=-1*o[u],isNaN(this.$)&&(this.$=0);break;case 26:this.$=1*o[u],isNaN(this.$)&&(this.$=0);break;case 27:this.$=Math.E;break;case 28:this.$=t.callFunction(o[u-2]);break;case 29:this.$=t.callFunction(o[u-3],o[u-1]);break;case 33:this.$=t.getCellValue(o[u]);break;case 34:this.$=t.getCellRangeValue(o[u-2],o[u]);break;case 35:this.$=t.getCellValue(o[u]);break;case 36:this.$=t.getCellRangeValue(o[u-2],o[u]);break;case 37:this.$=t.getRemoteCellValue(o[u-2],o[u]);break;case 38:this.$=t.getRemoteCellRangeValue(o[u-4],o[u-2],o[u]);break;case 39:this.$=t.getColumnRange(o[u]);break;case 40:this.$=t.getRemoteColumnRange(o[u-2],o[u]);break;case 41:this.$=[o[u]];break;case 42:case 43:o[u-2].push(o[u]),this.$=o[u-2];break;case 44:this.$=[o[u]];break;case 45:this.$=$.isArray(o[u-2])?o[u-2]:[o[u-2]],this.$.push(o[u]);break;case 46:this.$=1*o[u];break;case 47:this.$=1*(o[u-2]+"."+o[u]);break;case 48:this.$=.01*o[u-1];break;case 49:case 50:this.$=o[u-2]+o[u-1]+o[u]}},table:[{2:18,3:1,4:2,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{1:[3]},{5:[1,26],14:[1,27],15:[1,28],16:[1,29],22:[1,30],23:[1,31],24:[1,32],25:[1,33],26:[1,34],27:[1,35],28:[1,36]},{5:[2,2],14:[2,2],15:[2,2],16:[2,2],18:[2,2],21:[2,2],22:[2,2],23:[2,2],24:[2,2],25:[2,2],26:[2,2],27:[2,2],28:[2,2],38:[2,2],39:[2,2],41:[1,37]},{5:[2,3],14:[2,3],15:[2,3],16:[2,3],18:[2,3],21:[2,3],22:[2,3],23:[2,3],24:[2,3],25:[2,3],26:[2,3],27:[2,3],28:[2,3],38:[2,3],39:[2,3]},{5:[2,4],14:[2,4],15:[2,4],16:[2,4],18:[2,4],21:[2,4],22:[2,4],23:[2,4],24:[2,4],25:[2,4],26:[2,4],27:[2,4],28:[2,4],38:[2,4],39:[2,4]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],18:[2,5],21:[2,5],22:[2,5],23:[2,5],24:[2,5],25:[2,5],26:[2,5],27:[2,5],28:[2,5],38:[2,5],39:[2,5]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],18:[2,6],21:[2,6],22:[2,6],23:[2,6],24:[2,6],25:[2,6],26:[2,6],27:[2,6],28:[2,6],38:[2,6],39:[2,6]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],18:[2,7],21:[2,7],22:[2,7],23:[2,7],24:[2,7],25:[2,7],26:[2,7],27:[2,7],28:[2,7],38:[2,7],39:[2,7]},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],18:[2,8],21:[2,8],22:[2,8],23:[2,8],24:[2,8],25:[2,8],26:[2,8],27:[2,8],28:[2,8],38:[2,8],39:[2,8],43:[1,38]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],18:[2,9],21:[2,9],22:[2,9],23:[2,9],24:[2,9],25:[2,9],26:[2,9],27:[2,9],28:[2,9],38:[2,9],39:[2,9]},{2:18,4:39,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:41,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],20:40,25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:42,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:43,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{5:[2,27],14:[2,27],15:[2,27],16:[2,27],18:[2,27],21:[2,27],22:[2,27],23:[2,27],24:[2,27],25:[2,27],26:[2,27],27:[2,27],28:[2,27],38:[2,27],39:[2,27]},{17:[1,44]},{5:[2,30],14:[2,30],15:[2,30],16:[2,30],18:[2,30],21:[2,30],22:[2,30],23:[2,30],24:[2,30],25:[2,30],26:[2,30],27:[2,30],28:[2,30],38:[2,30],39:[2,30]},{2:45,5:[2,31],14:[2,31],15:[2,31],16:[2,31],18:[2,31],21:[2,31],22:[2,31],23:[2,31],24:[2,31],25:[2,31],26:[2,31],27:[2,31],28:[2,31],38:[2,31],39:[2,31],40:[1,46],44:[1,25]},{5:[2,44],14:[2,44],15:[2,44],16:[2,44],18:[2,44],21:[2,44],22:[2,44],23:[2,44],24:[2,44],25:[2,44],26:[2,44],27:[2,44],28:[2,44],38:[2,44],39:[2,44],41:[2,44],44:[1,47]},{5:[2,46],14:[2,46],15:[2,46],16:[2,46],18:[2,46],21:[2,46],22:[2,46],23:[2,46],24:[2,46],25:[2,46],26:[2,46],27:[2,46],28:[2,46],38:[2,46],39:[2,46],41:[1,48],43:[2,46]},{5:[2,33],14:[2,33],15:[2,33],16:[2,33],18:[2,33],21:[2,33],22:[2,33],23:[2,33],24:[2,33],25:[2,33],26:[2,33],27:[2,33],28:[2,33],33:[1,49],38:[2,33],39:[2,33]},{5:[2,35],14:[2,35],15:[2,35],16:[2,35],18:[2,35],21:[2,35],22:[2,35],23:[2,35],24:[2,35],25:[2,35],26:[2,35],27:[2,35],28:[2,35],33:[1,50],38:[2,35],39:[2,35]},{36:[1,51]},{5:[2,39],14:[2,39],15:[2,39],16:[2,39],18:[2,39],21:[2,39],22:[2,39],23:[2,39],24:[2,39],25:[2,39],26:[2,39],27:[2,39],28:[2,39],38:[2,39],39:[2,39]},{40:[1,52]},{1:[2,1]},{2:18,4:53,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:54,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:55,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:58,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],15:[1,56],16:[1,14],17:[1,11],19:[1,12],23:[1,57],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:60,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],15:[1,59],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:61,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:62,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:63,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:64,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:65,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{40:[1,66]},{5:[2,48],14:[2,48],15:[2,48],16:[2,48],18:[2,48],21:[2,48],22:[2,48],23:[2,48],24:[2,48],25:[2,48],26:[2,48],27:[2,48],28:[2,48],38:[2,48],39:[2,48],43:[2,48]},{14:[1,27],15:[1,28],16:[1,29],18:[1,67],22:[1,30],23:[1,31],24:[1,32],25:[1,33],26:[1,34],27:[1,35],28:[1,36]},{21:[1,68],38:[1,69],39:[1,70]},{14:[1,27],15:[1,28],16:[1,29],18:[2,41],21:[2,41],22:[1,30],23:[1,31],24:[1,32],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,41],39:[2,41]},{5:[2,25],14:[2,25],15:[2,25],16:[2,25],18:[2,25],21:[2,25],22:[2,25],23:[2,25],24:[2,25],25:[2,25],26:[1,34],27:[1,35],28:[1,36],38:[2,25],39:[2,25]},{5:[2,26],14:[2,26],15:[2,26],16:[2,26],18:[2,26],21:[2,26],22:[2,26],23:[2,26],24:[2,26],25:[2,26],26:[1,34],27:[1,35],28:[1,36],38:[2,26],39:[2,26]},{2:18,4:41,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],18:[1,71],19:[1,12],20:72,25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{5:[2,32],14:[2,32],15:[2,32],16:[2,32],18:[2,32],21:[2,32],22:[2,32],23:[2,32],24:[2,32],25:[2,32],26:[2,32],27:[2,32],28:[2,32],38:[2,32],39:[2,32]},{44:[1,47]},{40:[1,73]},{42:[1,74]},{32:[1,75]},{34:[1,76]},{34:[1,77],37:[1,78]},{36:[1,79]},{5:[2,10],14:[2,10],15:[2,10],16:[1,29],18:[2,10],21:[2,10],22:[1,30],23:[1,31],24:[1,32],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,10],39:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[1,29],18:[2,11],21:[2,11],22:[1,30],23:[1,31],24:[1,32],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,11],39:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],18:[2,12],21:[2,12],22:[2,12],23:[2,12],24:[2,12],25:[2,12],26:[1,34],27:[1,35],28:[1,36],38:[2,12],39:[2,12]},{2:18,4:80,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:81,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{5:[2,20],14:[2,20],15:[2,20],16:[1,29],18:[2,20],21:[2,20],22:[2,20],23:[2,20],24:[2,20],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,20],39:[2,20]},{2:18,4:82,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{5:[2,19],14:[2,19],15:[2,19],16:[1,29],18:[2,19],21:[2,19],22:[2,19],23:[2,19],24:[2,19],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,19],39:[2,19]},{5:[2,18],14:[2,18],15:[2,18],16:[1,29],18:[2,18],21:[2,18],22:[1,30],23:[1,31],24:[2,18],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,18],39:[2,18]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],18:[2,21],21:[2,21],22:[2,21],23:[2,21],24:[2,21],25:[2,21],26:[1,34],27:[1,35],28:[1,36],38:[2,21],39:[2,21]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],18:[2,22],21:[2,22],22:[2,22],23:[2,22],24:[2,22],25:[2,22],26:[2,22],27:[2,22],28:[1,36],38:[2,22],39:[2,22]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],18:[2,23],21:[2,23],22:[2,23],23:[2,23],24:[2,23],25:[2,23],26:[2,23],27:[2,23],28:[1,36],38:[2,23],39:[2,23]},{5:[2,24],14:[2,24],15:[2,24],16:[2,24],18:[2,24],21:[2,24],22:[2,24],23:[2,24],24:[2,24],25:[2,24],26:[2,24],27:[2,24],28:[2,24],38:[2,24],39:[2,24]},{5:[2,45],14:[2,45],15:[2,45],16:[2,45],18:[2,45],21:[2,45],22:[2,45],23:[2,45],24:[2,45],25:[2,45],26:[2,45],27:[2,45],28:[2,45],38:[2,45],39:[2,45],41:[2,45]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],18:[2,13],21:[2,13],22:[2,13],23:[2,13],24:[2,13],25:[2,13],26:[2,13],27:[2,13],28:[2,13],38:[2,13],39:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],18:[2,14],21:[2,14],22:[2,14],23:[2,14],24:[2,14],25:[2,14],26:[2,14],27:[2,14],28:[2,14],38:[2,14],39:[2,14]},{2:18,4:83,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{2:18,4:84,6:3,7:[1,4],8:[1,5],9:[1,6],10:[1,7],11:[1,8],12:9,13:[1,10],16:[1,14],17:[1,11],19:[1,12],25:[1,13],29:[1,15],30:[1,16],31:17,32:[1,21],34:[1,22],35:[1,23],37:[1,24],40:[1,19],42:[1,20],44:[1,25]},{5:[2,28],14:[2,28],15:[2,28],16:[2,28],18:[2,28],21:[2,28],22:[2,28],23:[2,28],24:[2,28],25:[2,28],26:[2,28],27:[2,28],28:[2,28],38:[2,28],39:[2,28]},{18:[1,85],38:[1,69],39:[1,70]},{36:[1,86]},{5:[2,47],14:[2,47],15:[2,47],16:[2,47],18:[2,47],21:[2,47],22:[2,47],23:[2,47],24:[2,47],25:[2,47],26:[2,47],27:[2,47],28:[2,47],38:[2,47],39:[2,47],43:[2,47]},{5:[2,34],14:[2,34],15:[2,34],16:[2,34],18:[2,34],21:[2,34],22:[2,34],23:[2,34],24:[2,34],25:[2,34],26:[2,34],27:[2,34],28:[2,34],38:[2,34],39:[2,34]},{5:[2,36],14:[2,36],15:[2,36],16:[2,36],18:[2,36],21:[2,36],22:[2,36],23:[2,36],24:[2,36],25:[2,36],26:[2,36],27:[2,36],28:[2,36],38:[2,36],39:[2,36]},{5:[2,37],14:[2,37],15:[2,37],16:[2,37],18:[2,37],21:[2,37],22:[2,37],23:[2,37],24:[2,37],25:[2,37],26:[2,37],27:[2,37],28:[2,37],33:[1,87],38:[2,37],39:[2,37]},{5:[2,40],14:[2,40],15:[2,40],16:[2,40],18:[2,40],21:[2,40],22:[2,40],23:[2,40],24:[2,40],25:[2,40],26:[2,40],27:[2,40],28:[2,40],38:[2,40],39:[2,40]},{5:[2,49],14:[2,49],15:[2,49],16:[2,49],18:[2,49],21:[2,49],22:[2,49],23:[2,49],24:[2,49],25:[2,49],26:[2,49],27:[2,49],28:[2,49],38:[2,49],39:[2,49],40:[2,49],44:[2,49]},{5:[2,15],14:[2,15],15:[2,15],16:[1,29],18:[2,15],21:[2,15],22:[2,15],23:[2,15],24:[2,15],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,15],39:[2,15]},{5:[2,17],14:[2,17],15:[2,17],16:[1,29],18:[2,17],21:[2,17],22:[2,17],23:[2,17],24:[2,17],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,17],39:[2,17]},{5:[2,16],14:[2,16],15:[2,16],16:[1,29],18:[2,16],21:[2,16],22:[2,16],23:[2,16],24:[2,16],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,16],39:[2,16]},{14:[1,27],15:[1,28],16:[1,29],18:[2,42],21:[2,42],22:[1,30],23:[1,31],24:[1,32],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,42],39:[2,42]},{14:[1,27],15:[1,28],16:[1,29],18:[2,43],21:[2,43],22:[1,30],23:[1,31],24:[1,32],25:[1,33],26:[1,34],27:[1,35],28:[1,36],38:[2,43],39:[2,43]},{5:[2,29],14:[2,29],15:[2,29],16:[2,29],18:[2,29],21:[2,29],22:[2,29],23:[2,29],24:[2,29],25:[2,29],26:[2,29],27:[2,29],28:[2,29],38:[2,29],39:[2,29]},{5:[2,50],14:[2,50],15:[2,50],16:[2,50],18:[2,50],21:[2,50],22:[2,50],23:[2,50],24:[2,50],25:[2,50],26:[2,50],27:[2,50],28:[2,50],38:[2,50],39:[2,50],40:[2,50],44:[2,50]},{34:[1,88]},{5:[2,38],14:[2,38],15:[2,38],16:[2,38],18:[2,38],21:[2,38],22:[2,38],23:[2,38],24:[2,38],25:[2,38],26:[2,38],27:[2,38],28:[2,38],38:[2,38],39:[2,38]}],defaultActions:{26:[2,1]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e=this,n=[0],r=[null],i=[],a=this.table,o="",l=0,u=0,s=0,c=2,f=1,h=i.slice.call(arguments,1);this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;i.push(d);var m=this.lexer.options&&this.lexer.options.ranges;function g(){var t;return"number"!=typeof(t=e.lexer.lex()||f)&&(t=e.symbols_[t]||t),t}"function"==typeof this.yy.parseError?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var M,p,v,E,N,R,y,A,I,S,C={};;){if(v=n[n.length-1],this.defaultActions[v]?E=this.defaultActions[v]:(null!==M&&void 0!==M||(M=g()),E=a[v]&&a[v][M]),void 0===E||!E.length||!E[0]){var x,U="";function b(t){for(var e=n.length-1,r=0;;){if(c.toString()in a[t])return r;if(0===t||e<2)return!1;t=n[e-=2],++r}}if(s)p!==f&&(x=b(v));else{x=b(v),I=[];for(R in a[v])this.terminals_[R]&&R>c&&I.push("'"+this.terminals_[R]+"'");U=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+I.join(", ")+", got '"+(this.terminals_[M]||M)+"'":"Parse error on line "+(l+1)+": Unexpected "+(M==f?"end of input":"'"+(this.terminals_[M]||M)+"'"),this.parseError(U,{text:this.lexer.match,token:this.terminals_[M]||M,line:this.lexer.yylineno,loc:d,expected:I,recoverable:!1!==x})}if(3==s){if(M===f||p===f)throw new Error(U||"Parsing halted while starting to recover from another error.");u=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,M=g()}if(!1===x)throw new Error(U||"Parsing halted. No suitable error recovery rule available.");S=x,n.length=n.length-2*S,r.length=r.length-S,i.length=i.length-S,p=M==c?null:M,M=c,v=n[n.length-1],E=a[v]&&a[v][c],s=3}if(E[0]instanceof Array&&E.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+M);switch(E[0]){case 1:n.push(M),r.push(this.lexer.yytext),i.push(this.lexer.yylloc),n.push(E[1]),M=null,p?(M=p,p=null):(u=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,s>0&&s--);break;case 2:if(y=this.productions_[E[1]][1],C.$=r[r.length-y],C._$={first_line:i[i.length-(y||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(y||1)].first_column,last_column:i[i.length-1].last_column},m&&(C._$.range=[i[i.length-(y||1)].range[0],i[i.length-1].range[1]]),void 0!==(N=this.performAction.apply(C,[o,u,l,this.yy,E[1],r,i].concat(h))))return N;y&&(n=n.slice(0,-1*y*2),r=r.slice(0,-1*y),i=i.slice(0,-1*y)),n.push(this.productions_[E[1]][0]),r.push(C.$),i.push(C._$),A=a[n[n.length-2]][n[n.length-1]],n.push(A);break;case 3:return!0}}return!0}},n={EOF:1,parseError:function(t,e){"use strict";if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){"use strict";return this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){"use strict";var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){"use strict";var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){"use strict";return this._more=!0,this},reject:function(){"use strict";return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){"use strict";this.unput(this.match.slice(t))},pastInput:function(){"use strict";var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){"use strict";var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){"use strict";var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){"use strict";var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(r=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var a in i)this[a]=i[a];return!1}return!1},next:function(){"use strict";if(this.done)return this.EOF;var t,e,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),a=0;a<i.length;a++)if((n=this._input.match(this.rules[i[a]]))&&(!e||n[0].length>e[0].length)){if(e=n,r=a,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,i[a])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,i[r]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){"use strict";var t=this.next();return t||this.lex()},begin:function(t){"use strict";this.conditionStack.push(t)},popState:function(){"use strict";return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){"use strict";return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){"use strict";return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){"use strict";this.begin(t)},stateStackSize:function(){"use strict";return this.conditionStack.length},options:{},performAction:function(e,n,r,i){switch(r){case 0:break;case 1:case 2:return 13;case 3:return 35;case 4:return 30;case 5:return 10;case 6:return 11;case 7:return"cell"==t.obj.type?32:40;case 8:return"cell"==t.obj.type?34:40;case 9:return 37;case 10:return 30;case 11:case 12:return 40;case 13:return 42;case 14:break;case 15:return" ";case 16:return 41;case 17:return 33;case 18:return 38;case 19:return 39;case 20:return 26;case 21:return 27;case 22:return 25;case 23:return 16;case 24:return 28;case 25:return 17;case 26:return 18;case 27:return 19;case 28:return 21;case 29:return 23;case 30:return 22;case 31:return 24;case 32:return"PI";case 33:return 29;case 34:return 7;case 35:return 8;case 36:return 9;case 37:return'"';case 38:return"'";case 39:return"!";case 40:return 15;case 41:return 43;case 42:return 44;case 43:return 14;case 44:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:#[A-Za-z0-9_]+)/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+[:][A-Za-z]+)/,/^(?:[A-Za-z]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\[)/,/^(?:\])/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:TRUE\b)/,/^(?:FALSE\b)/,/^(?:NULL\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:[&])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!0}}};function r(){this.yy={}}return e.lexer=n,r.prototype=e,e.Parser=r,new r}var formula={custom:{},date:{DATE:function(t,e,n){return void 0===moment?data.ERRKEY.momentRequired:void 0===e?moment(t):new Date(t,e-1,n)},DATEDIFF:function(t,e,n){return void 0===moment?data.ERRKEY.momentRequired:moment(e).diff(moment.utc(t),n)},DATEFORMAT:function(t,e){return void 0===moment?data.ERRKEY.momentRequired:moment(t).format(e)},DATEVALUE:function(t){return void 0===moment?data.ERRKEY.momentRequired:Math.ceil((moment(t)-moment("1900-1-1"))/864e5)+2},DAY:function(t){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).date()},DAYNAME:function(t){return data.DAY_NAME[formula.date.WEEKDAY(t)-1]},DAYS:function(t,e){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).diff(moment(new Date(e)),"days")},DAYS360:function(t,e,n){if(void 0===moment)return data.ERRKEY.momentRequired;var r=moment(new Date(t)),i=moment(new Date(e)),a=31,o=31,l=r.date(),u=i.date();return n?(l=31===l?30:l,u=31===u?30:u):(1===r.month()&&(a=r.daysInMonth()),1===i.month()&&(o=i.daysInMonth()),30!==(l=l===a?30:l)&&l!==a||(u=u===o?30:u)),360*(i.year()-r.year())+30*(i.month()-r.month())+(u-l)},EDATE:function(t,e){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).add("months",e).toDate()},EOMONTH:function(t,e){if(void 0===moment)return data.ERRKEY.momentRequired;var n=moment(new Date(t)).add("months",e);return new Date(n.year(),n.month(),n.daysInMonth())},FROMNOW:function(t,e){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).fromNow(e)},HOUR:function(t){return void 0===moment?data.ERRKEY.momentRequired:t<=1?Math.floor(24*t):moment(new Date(t)).hours()},MINUTE:function(t){return void 0===moment?data.ERRKEY.momentRequired:t<=1?Math.floor(1440*t)-60*Math.floor(24*t):moment(new Date(t)).minutes()},ISOWEEKNUM:function(t){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).format("w")},MONTH:function(t){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).month()+1},NETWORKDAYS:function(t,e,n){return formula.date.NETWORKDAYSINTL(t,e,1,n)},NETWORKDAYSINTL:function(t,e,n,r){if(void 0===moment)return data.ERRKEY.momentRequired;var i=void 0===n?1:n,a=data.WEEKEND_TYPES[i],o=moment(t),l=moment(e).diff(o,"days")+1,u=l,s="",c=o,f=[];if(void 0!==r)for(var h=0;h<r.length;h++)f[h]=moment(new Date(r[h])).format("MM-DD-YYYY");for(var d=0;d<l;)s=c.format("d"),a.indexOf(parseInt(s,10))>=0?u--:f.indexOf(c.format("MM-DD-YYYY"))>=0&&u--,c=c.add("days",1),d++;return u},NOW:function(){return new Date},SECOND:function(t){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).seconds()},TIME:function(t,e,n){return(3600*t+60*e+n)/86400},TIMEVALUE:function(t){if(void 0===moment)return data.ERRKEY.momentRequired;var e=moment(new Date(t));return(3600*e.hours()+60*e.minutes()+e.seconds())/86400},TODAY:function(){return new Date},WEEKDAY:function(t,e){if(void 0===moment)return data.ERRKEY.momentRequired;var n=moment(new Date(t)).format("d"),r=void 0===e?1:e;return data.WEEK_TYPES[r][n]},WEEKNUM:function(t,e){if(void 0===moment)return data.ERRKEY.momentRequired;var n=moment(new Date(t)),r=moment(new Date(n.year(),0,1)),i=void 0===e?1:e,a=data.WEEK_STARTS[i],o=r.format("d"),l=o<a?a-o+1:o-a;return 21===i?formula.date.ISOWEEKNUM(t):Math.floor(n.diff(r.subtract("days",l),"days")/7)+1},WORKDAY:function(t,e,n){return formula.date.WORKDAYINTL(t,e,1,n)},WORKDAYINTL:function(t,e,n,r){if(void 0===moment)return data.ERRKEY.momentRequired;var i=void 0===n?1:n,a=data.WEEKEND_TYPES[i],o=moment(new Date(t)),l="",u=[];if(void 0!==r)for(var s=0;s<r.length;s++)u[s]=moment(new Date(r[s])).format("MM-DD-YYYY");for(var c=0;c<e;)l=(o=o.add("days",1)).format("d"),a.indexOf(parseInt(l,10))<0&&u.indexOf(o.format("MM-DD-YYYY"))<0&&c++;return o.toDate()},YEAR:function(t){return void 0===moment?data.ERRKEY.momentRequired:moment(new Date(t)).year()},YEARFRAC:function(t,e,n){if(void 0===moment)return data.ERRKEY.momentRequired;n=void 0===n?0:n;var r=moment(new Date(t)),i=moment(new Date(e));if(!r.isValid()||!i.isValid())return"#VALUE!";if(-1===[0,1,2,3,4].indexOf(n))return"#NUM!";if(r===i)return 0;r.diff(i)>0&&(i=moment(new Date(t)),r=moment(new Date(e)));var a=r.year(),o=r.month(),l=r.date(),u=i.year(),s=i.month(),c=i.date();switch(n){case 0:return 31===l&&31===c?(l=30,c=30):31===l?l=30:30===l&&31===c?c=30:1===o&&1===s&&r.daysInMonth()===l&&i.daysInMonth()===c?(l=30,c=30):1===o&&r.daysInMonth()===l&&(l=30),(c+30*s+360*u-(l+30*o+360*a))/360;case 1:var f=365;if(a===u||a+1===u&&(o>s||o===s&&l>=c))return a===u&&moment([a]).isLeapYear()?f=366:(function(t,e){var n=moment(new Date(t.year(),2,1));if(moment([t.year()]).isLeapYear()&&t.diff(n)<0&&e.diff(n)>=0)return!0;var r=moment(new Date(e.year(),2,1));return!!(moment([e.year()]).isLeapYear()&&e.diff(r)>=0&&t.diff(r)<0)}(r,i)||1===s&&29===c)&&(f=366),i.diff(r,"days")/f;var h=u-a+1,d=moment(new Date(u+1,0,1)).diff(moment(new Date(a,0,1)),"days")/h;return i.diff(r,"days")/d;case 2:return i.diff(r,"days")/360;case 3:return i.diff(r,"days")/365;case 4:return 31===l&&(l=30),31===c&&(c=30),(c+30*s+360*u-(l+30*o+360*a))/360}}},math:{ABS:function(t){return Math.abs(t)},ACOS:function(t){return Math.acos(t)},ACOSH:function(t){return Math.log(t+Math.sqrt(t*t-1))},ACOT:function(t){return Math.atan(1/t)},ACOTH:function(t){return.5*Math.log((t+1)/(t-1))},AGGREGATE:function(t,e){for(var n=[],r=2;r<arguments.length;r++)switch(t){case 1:n[r-2]=formula.statistic.AVERAGE(arguments[r]);break;case 2:n[r-2]=formula.statistic.COUNT(arguments[r]);break;case 3:n[r-2]=formula.statistic.COUNTA(arguments[r]);break;case 4:n[r-2]=formula.statistic.MAX(arguments[r]);break;case 5:n[r-2]=formula.statistic.MIN(arguments[r]);break;case 6:n[r-2]=formula.statistic.PRODUCT(arguments[r]);break;case 7:n[r-2]=formula.statistic.STDEVS(arguments[r]);break;case 8:n[r-2]=formula.statistic.STDEVP(arguments[r]);break;case 9:n[r-2]=formula.math.SUM(arguments[r]);break;case 10:n[r-2]=formula.statistic.VARS(arguments[r]);break;case 11:n[r-2]=formula.statistic.VARP(arguments[r]);break;case 12:n[r-2]=formula.statistic.MEDIAN(arguments[r]);break;case 13:n[r-2]=formula.statistic.MODESNGL(arguments[r]);break;case 14:n[r-2]=formula.statistic.LARGE(arguments[r]);break;case 15:n[r-2]=formula.statistic.SMALL(arguments[r]);break;case 16:n[r-2]=formula.statistic.PERCENTILEINC(arguments[r]);break;case 17:n[r-2]=formula.statistic.QUARTILEINC(arguments[r]);break;case 18:n[r-2]=formula.statistic.PERCENTILEEXC(arguments[r]);break;case 19:n[r-2]=formula.statistic.QUARTILEEXC(arguments[r])}return n},ARABIC:function(t){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return"#VALUE!";var e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),e},ASIN:function(t){return Math.asin(t)},ASINH:function(t){return Math.log(t+Math.sqrt(t*t+1))},ATAN:function(t){return Math.atan(t)},ATAN2:function(t,e){return Math.atan2(t,e)},ATANH:function(t){return Math.log((1+t)/(1-t))/2},BASE:function(t,e,n){n=void 0===n?0:n;var r=t.toString(e);return new Array(Math.max(n+1-r.length,0)).join("0")+r},CEILING:function(t,e,n){if(0===e)return 0;e=void 0===e?1:Math.abs(e),n=void 0===n?0:n;var r=-Math.floor(Math.log(e)/Math.log(10));return t>=0?formula.math.ROUND(Math.ceil(t/e)*e,r):0===n?-formula.math.ROUND(Math.floor(Math.abs(t)/e)*e,r):-formula.math.ROUND(Math.ceil(Math.abs(t)/e)*e,r)},CEILINGMATH:function(t,e,n){return formula.math.CEILING(t,e,n)},CEILINGPRECISE:function(t,e,n){return formula.math.CEILING(t,e,n)},COMBIN:function(t,e){return formula.math.FACT(t)/(formula.math.FACT(e)*formula.math.FACT(t-e))},COMBINA:function(t,e){return 0===t&&0===e?1:formula.math.COMBIN(t+e-1,t-1)},COS:function(t){return Math.cos(t)},COSH:function(t){return(Math.exp(t)+Math.exp(-t))/2},COT:function(t){return 1/Math.tan(t)},COTH:function(t){var e=Math.exp(2*t);return(e+1)/(e-1)},CSC:function(t){return 1/Math.sin(t)},CSCH:function(t){return 2/(Math.exp(t)-Math.exp(-t))},DECIMAL:function(t,e){return parseInt(t,e)},DEGREES:function(t){return 180*t/Math.PI},DIVIDE:function(t,e){return""===t||""===e?"":0==e?"#DIV/0":parseFloat(t)/parseFloat(e)},EVEN:function(t){return formula.math.CEILING(t,-2,-1)},EXP:function(t){return Math.exp(t)},FACT:function(t){var e=Math.floor(t);return 0===e||1===e?1:data.MEMOIZED_FACT[e]>0?data.MEMOIZED_FACT[e]:(data.MEMOIZED_FACT[e]=formula.math.FACT(e-1)*e,data.MEMOIZED_FACT[e])},FACTDOUBLE:function(t){var e=Math.floor(t);return e<=0?1:e*formula.math.FACTDOUBLE(e-2)},FLOOR:function(t,e,n){if(0===e)return 0;e=void 0===e?1:Math.abs(e),n=void 0===n?0:n;var r=-Math.floor(Math.log(e)/Math.log(10));return t>=0?formula.math.ROUND(Math.floor(t/e)*e,r):0===n?-formula.math.ROUND(Math.ceil(Math.abs(t)/e)*e,r):-formula.math.ROUND(Math.floor(Math.abs(t)/e)*e,r)},FLOORMATH:function(t,e,n){return formula.math.FLOOR(t,e,n)},FLOORPRECISE:function(t,e,n){return formula.math.FLOOR(t,e,n)},GCD:function(){for(var t,e,n=arguments.length-1,r=arguments[n];n;)for(e=arguments[--n];t=e%r;e=r,r=t);return r},INT:function(t){return Math.floor(t)},ISEVEN:function(t){return!(1&Math.floor(Math.abs(t)))},ISOCEILING:function(t,e,n){return formula.math.CEILING(t,e,n)},ISODD:function(t){return!!(1&Math.floor(Math.abs(t)))},LCM:function(){for(var t,e,n,r,i=utility.toArray(arguments),a=1;void 0!==(n=i.pop());)for(;n>1;){if(n%2){for(t=3,e=Math.floor(Math.sqrt(n));t<=e&&n%t;t+=2);r=t<=e?t:n}else r=2;for(n/=r,a*=r,t=i.length;t;i[--t]%r==0&&1==(i[t]/=r)&&i.splice(t,1));}return a},LN:function(t){return Math.log(t)},LOG:function(t,e){return e=void 0===e?10:e,Math.log(t)/Math.log(e)},LOG10:function(t){return Math.log(t)/Math.log(10)},MOD:function(t,e){var n=Math.abs(t%e);return e>0?n:-n},MROUND:function(t,e){if(t*e<0)throw new Error("Number and multiple must have the same sign.");return Math.round(t/e)*e},MULTINOMIAL:function(){for(var t=0,e=1,n=0;n<arguments.length;n++)t+=arguments[n],e*=formula.math.FACT(arguments[n]);return formula.math.FACT(t)/e},MULTIPLY:function(t,e){return""===t||""===e?"":(t=isNaN(parseFloat(t))?0:parseFloat(t))*(e=isNaN(parseFloat(e))?0:parseFloat(e))},ODD:function(t){var e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},PI:function(){return Math.PI},POWER:function(t,e){return Math.pow(t,e)},PRODUCT:function(){for(var t=1,e=0;e<arguments.length;e++)t*=arguments[e];return t},QUOTIENT:function(t,e){return(t/e).toFixed(0)},RADIANS:function(t){return t*Math.PI/180},RAND:function(){return Math.random()},RANDBETWEEN:function(t,e){return t+Math.ceil((e-t+1)*Math.random())-1},ROUND:function(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)},ROUNDDOWN:function(t,e){return(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},ROUNDUP:function(t,e){return(t>0?1:-1)*Math.ceil(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)},SERIESSUM:function(t,e,n,r){for(var i=r[0]*Math.pow(t,e),a=1;a<r.length;a++)i+=r[a]*Math.pow(t,e+a*n);return i},SEC:function(t){return 1/Math.cos(t)},SECH:function(t){return 2/(Math.exp(t)+Math.exp(-t))},SIGN:function(t){return t<0?-1:0===t?0:1},SIN:function(t){return Math.sin(t)},SINH:function(t){return(Math.exp(t)-Math.exp(-t))/2},SQRT:function(t){return Math.sqrt(t)},SQRTPI:function(t){return Math.sqrt(t*Math.PI)},SUBTOTAL:function(t){for(var e=[],n=1;n<arguments.length;n++)switch(t){case 1:e[n-1]=formula.statistic.AVERAGE(arguments[n]);break;case 2:e[n-1]=formula.statistic.COUNT(arguments[n]);break;case 3:e[n-1]=formula.statistic.COUNTA(arguments[n]);break;case 4:e[n-1]=formula.statistic.MAX(arguments[n]);break;case 5:e[n-1]=formula.statistic.MIN(arguments[n]);break;case 6:e[n-1]=formula.statistic.PRODUCT(arguments[n]);break;case 7:e[n-1]=formula.statistic.STDEV(arguments[n]);break;case 8:e[n-1]=formula.statistic.STDEVP(arguments[n]);break;case 9:e[n-1]=formula.math.SUM(arguments[n]);break;case 10:e[n-1]=formula.statistic.VAR(arguments[n]);break;case 11:e[n-1]=formula.statistic.VARP(arguments[n])}return e},SUBTRACT:function(t,e){return""===t&&""===e?"":(t=isNaN(parseFloat(t))?0:parseFloat(t))-(e=isNaN(parseFloat(e))?0:parseFloat(e))},SUM:function(){var t,e,n="",r=0;for(e=0;e<arguments.length;e++)if("object"==typeof arguments[e])for(t in arguments[e])n+=void 0!==arguments[e][t]?arguments[e][t]:"",r+=isNaN(parseFloat(arguments[e][t],10))?0:parseFloat(arguments[e][t],10);else n+=void 0!==arguments[e]?arguments[e]:"",r+=isNaN(parseFloat(arguments[e],10))?0:parseFloat(arguments[e],10);return 0===r&&""===$.trim(n)?"":r},SUMIF:function(t,e,n){var r=0;t=utility.objectToArray(t),n=void 0===n?t:utility.objectToArray(n);for(var i=0;i<t.length;i++)this.evaluate(t[i]+e)&&(r+=n[i]);return r},SUMIFS:function(){for(var t=(arguments.length-1)/2,e=utility.objectToArray(arguments[0]),n=0,r=0;r<e.length;r++){for(var i=!0,a=0;a<t;a++){var o=arguments[2*a+1],l=utility.objectToArray(arguments[2*a+2]);i&&(i=this.evaluate(l[r]+o))}n+=i?e[r]:0}return n},SUMPRODUCT:function(){for(var t in arguments)if(arguments[t]=utility.objectToArray(arguments[t]),t>0&&arguments[t-1].length!==arguments[t].length)return"#VALUE!";for(var e=[],n=0;n<arguments.length;n++)for(var r=0;r<arguments[n].length;r++)e[r]=0==n?arguments[n][r]:formula.math.MULTIPLY(e[r],arguments[n][r]);return formula.math.SUM(e)},SUMSQ:function(){for(var t=utility.toArray(arguments),e=0,n=0;n<t.length;n++)e+=$.isNumeric(t[n])?t[n]*t[n]:0;return e},SUMX2MY2:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*t[r]-e[r]*e[r];return n},SUMX2PY2:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*t[r]+e[r]*e[r];return n},SUMXMY2:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n},TAN:function(t){return Math.tan(t)},TANH:function(t){var e=Math.exp(2*t);return(e-1)/(e+1)},TRUNC:function(t,e){return e=void 0===e?0:e,(t>0?1:-1)*Math.floor(Math.abs(t)*Math.pow(10,e))/Math.pow(10,e)}},financial:{ACCRINT:function(t,e,n,r,i,a,o,l){if(void 0===moment)return"#NAME?";if(!moment(t).isValid()||!moment(e).isValid()||!moment(n).isValid())return"#VALUE!";if(r<=0||i<=0)return"#NUM!";if(-1===[1,2,4].indexOf(a))return"#NUM!";if(-1===[0,1,2,3,4].indexOf(o))return"#NUM!";if(moment(t).diff(moment(n))>=0)return"#NUM!";i=void 0===i?0:i,o=void 0===o?0:o,l=void 0===l||l;var u=0,s=moment(new Date(t));moment(new Date(e)),moment(new Date(n)),moment([s.year()]).isLeapYear();switch(o){case 0:case 1:case 2:case 3:case 4:u=formula.date.YEARFRAC(t,n,o)}return i*r*u},ACCRINTM:function(){},AMORDEGRC:function(){},AMORLINC:function(){},COUPDAYBS:function(){},COUPDAYS:function(){},COUPDAYSNC:function(){},COUPNCD:function(){},COUPNUM:function(){},COUPPCD:function(){},CUMIPMT:function(t,e,n,r,i,a){if(t<=0||e<=0||n<=0)return"#NUM!";if(r<1||i<1||r>i)return"#NUM!";if(0!==a&&1!==a)return"#NUM!";var o=formula.financial.PMT(t,e,n,0,a),l=0;1===r&&0===a&&(l=-n,r++);for(var u=r;u<=i;u++)l+=1===a?formula.financial.FV(t,u-2,o,n,1)-o:formula.financial.FV(t,u-1,o,n,0);return l*=t},CUMPRINC:function(t,e,n,r,i,a){if(t<=0||e<=0||n<=0)return"#NUM!";if(r<1||i<1||r>i)return"#NUM!";if(0!==a&&1!==a)return"#NUM!";var o=formula.financial.PMT(t,e,n,0,a),l=0;1===r&&(l=0===a?o+n*t:o,r++);for(var u=r;u<=i;u++)l+=a>0?o-(formula.financial.FV(t,u-2,o,n,1)-o)*t:o-formula.financial.FV(t,u-1,o,n,0)*t;return l},DB:function(t,e,n,r,i){if(i=void 0===i?12:i,isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||isNaN(i))return"#VALUE!";if(t<0||e<0||n<0||r<0)return"#NUM!";if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i))return"#NUM!";if(r>n)return"#NUM!";if(e>=t)return 0;for(var a=(1-Math.pow(e/t,1/n)).toFixed(3),o=t*a*i/12,l=o,u=0,s=r===n?n-1:r,c=2;c<=s;c++)l+=u=(t-l)*a;return 1===r?o:r===n?(t-l)*a:u},DDB:function(t,e,n,r,i){if(i=void 0===i?2:i,isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)||isNaN(i))return"#VALUE!";if(t<0||e<0||n<0||r<0||i<=0)return"#NUM!";if(r>n)return"#NUM!";if(e>=t)return 0;for(var a=0,o=0,l=1;l<=r;l++)a+=o=Math.min(i/n*(t-a),t-e-a);return o},DISC:function(){},DOLLARDE:function(t,e){if(isNaN(t)||isNaN(e))return"#VALUE!";if(e<0)return"#NUM!";if(e>=0&&e<1)return"#DIV/0!";e=parseInt(e,10);var n=parseInt(t,10);n+=t%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;var r=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return n=Math.round(n*r)/r},DOLLARFR:function(t,e){if(isNaN(t)||isNaN(e))return"#VALUE!";if(e<0)return"#NUM!";if(e>=0&&e<1)return"#DIV/0!";e=parseInt(e,10);var n=parseInt(t,10);return n+=t%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e},DURATION:function(){},EFFECT:function(t,e){return isNaN(t)||isNaN(e)?"#VALUE!":t<=0||e<1?"#NUM!":(e=parseInt(e,10),Math.pow(1+t/e,e)-1)},FV:function(t,e,n,r,i){var a;if(i=void 0===i?0:i,0===t)a=r+n*e;else{var o=Math.pow(1+t,e);a=1===i?r*o+n*(1+t)*(o-1)/t:r*o+n*(o-1)/t}return-a},FVSCHEDULE:function(t,e){for(var n=t,r=0;r<e.length;r++){if(isNaN(e[r]))return"#VALUE!";n*=1+e[r]}return n},INTRATE:function(){},IPMT:function(t,e,n,r,i,a){a=void 0===a?0:a;var o=formula.financial.PMT(t,n,r,i,a);return(1===e?1===a?0:-r:1===a?formula.financial.FV(t,e-2,o,r,1)-o:formula.financial.FV(t,e-1,o,r,0))*t},IRR:function(t,e){var n,r=[];for(var i in t)n=parseFloat(t[i],10),n=isNaN(n)?0:n,r.push(n);for(var a=function(t,e,n){for(var r=n+1,i=t[0],a=1;a<t.length;a++)i+=t[a]/Math.pow(r,(e[a]-e[0])/365);return i},o=function(t,e,n){for(var r=n+1,i=0,a=1;a<t.length;a++){var o=(e[a]-e[0])/365;i-=o*t[a]/Math.pow(r,o+1)}return i},l=[],u=!1,s=!1,c=0;c<r.length;c++)l[c]=0===c?0:l[c-1]+365,r[c]>0&&(u=!0),r[c]<0&&(s=!0);if(!u||!s)return"#NUM!";var f,h,d,m=e=void 0===e?.1:e,g=0,M=!0;do{f=m-(d=a(r,l,m))/o(r,l,m),h=Math.abs(f-m),m=f,M=h>1e-10&&Math.abs(d)>1e-10}while(M&&++g<50);return M?"#NUM!":m},ISPMT:function(t,e,n,r){return r*t*(e/n-1)},MDURATION:function(){},MIRR:function(t,e,n){var r=[];for(var i in t)r.push(t[i]);for(var a=r.length,o=[],l=[],u=0;u<a;u++)r[u]<0?o.push(r[u]):l.push(r[u]);var s=-formula.financial.NPV(n,l)*Math.pow(1+n,a-1),c=formula.financial.NPV(e,o)*(1+e);return Math.pow(s/c,1/(a-1))-1},NOMINAL:function(t,e){return isNaN(t)||isNaN(e)?"#VALUE!":t<=0||e<1?"#NUM!":(e=parseInt(e,10),(Math.pow(t+1,1/e)-1)*e)},NPER:function(t,e,n,r,i){var a=e*(1+t*(i=void 0===i?0:i))-(r=void 0===r?0:r)*t,o=n*t+e*(1+t*i);return Math.log(a/o)/Math.log(1+t)},NPV:function(){for(var t,e=[],n=0;n<arguments.length;n++)if("object"==typeof arguments[n])for(var r in arguments[n])t=parseFloat(arguments[n][r],10),t=isNaN(t)?0:t,e=e.concat([t]);else t=parseFloat(arguments[n],10),t=isNaN(t)?0:t,e=e.concat([t]);for(var i=e[0],a=0,o=1;o<e.length;o++)a+=e[o]/Math.pow(1+i,o);return a},ODDFPRICE:function(){},ODDFYIELD:function(){},ODDLPRICE:function(){},ODDLYIELD:function(){},PDURATION:function(t,e,n){return isNaN(t)||isNaN(e)||isNaN(n)?"#VALUE!":t<=0?"#NUM!":(Math.log(n)-Math.log(e))/Math.log(1+t)},PMT:function(t,e,n,r,i){var a;if(i=void 0===i?0:i,r=void 0===r?0:r,0===t)a=(n+r)/e;else{var o=Math.pow(1+t,e);a=1===i?(r*t/(o-1)+n*t/(1-1/o))/(1+t):r*t/(o-1)+n*t/(1-1/o)}return-a},PPMT:function(t,e,n,r,i,a){return formula.financial.PMT(t,n,r,i,a)-formula.financial.IPMT(t,e,n,r,i,a)},PRICE:function(){},PRICEDISC:function(){},PRICEMAT:function(){},PV:function(t,e,n,r,i){return i=void 0===i?0:i,r=void 0===r?0:r,0===t?-n*e-r:((1-Math.pow(1+t,e))/t*n*(1+t*i)-r)/Math.pow(1+t,e)},RATE:function(t,e,n,r,i,a){a=void 0===a?.01:a,r=void 0===r?0:r,i=void 0===i?0:i;var o,l,u,s=0,c=0,f=0,h=a;for(Math.abs(h)<1e-10?n*(1+t*h)+e*(1+h*i)*t+r:n*(c=Math.exp(t*Math.log(1+h)))+e*(1/h+i)*(c-1)+r,o=n+e*t+r,l=n*c+e*(1/h+i)*(c-1)+r,f=u=0,s=h;Math.abs(o-l)>1e-10&&f<50;)h=(l*u-o*s)/(l-o),u=s,s=h,o=l,l=Math.abs(h)<1e-10?n*(1+t*h)+e*(1+h*i)*t+r:n*(c=Math.exp(t*Math.log(1+h)))+e*(1/h+i)*(c-1)+r,++f;return h},RECEIVED:function(){},RRI:function(t,e,n){return isNaN(t)||isNaN(e)||isNaN(n)?"#VALUE!":0===t||0===e?"#NUM!":Math.pow(n/e,1/t)-1},SLN:function(t,e,n){return isNaN(t)||isNaN(e)||isNaN(n)?"#VALUE!":0===n?"#NUM!":(t-e)/n},SYD:function(t,e,n,r){return isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)?"#VALUE!":0===n?"#NUM!":r<1||r>n?"#NUM!":(t-e)*(n-(r=parseInt(r,10))+1)*2/(n*(n+1))},TBILLEQ:function(t,e,n){return moment(t).isValid()&&moment(e).isValid()?n<=0?"#NUM!":moment(t).diff(moment(e))>0?"#NUM!":moment(e).diff(moment(t),"years")>1?"#NUM!":365*n/(360-n*formula.date.DAYS360(t,e)):"#VALUE!"},TBILLPRICE:function(t,e,n){return moment(t).isValid()&&moment(e).isValid()?n<=0?"#NUM!":moment(t).diff(moment(e))>0?"#NUM!":moment(e).diff(moment(t),"years")>1?"#NUM!":100*(1-n*formula.date.DAYS360(t,e)/360):"#VALUE!"},TBILLYIELD:function(t,e,n){return moment(t).isValid()&&moment(e).isValid()?n<=0?"#NUM!":moment(t).diff(moment(e))>0?"#NUM!":moment(e).diff(moment(t),"years")>1?"#NUM!":360*(100-n)/(n*formula.date.DAYS360(t,e)):"#VALUE!"},VDB:function(){},XIRR:function(t,e,n){var r=[];for(var i in t)r.push(t[i]);for(var a=function(t,e,n){for(var r=n+1,i=t[0],a=1;a<t.length;a++)i+=t[a]/Math.pow(r,moment(e[a]).diff(moment(e[0]),"days")/365);return i},o=function(t,e,n){for(var r=n+1,i=0,a=1;a<t.length;a++){var o=moment(e[a]).diff(moment(e[0]),"days")/365;i-=o*t[a]/Math.pow(r,o+1)}return i},l=!1,u=!1,s=0;s<r.length;s++)r[s]>0&&(l=!0),r[s]<0&&(u=!0);if(!l||!u)return"#NUM!";var c,f,h,d=n=n||.1,m=0,g=!0;do{c=d-(h=a(r,e,d))/o(r,e,d),f=Math.abs(c-d),d=c,g=f>1e-10&&Math.abs(h)>1e-10}while(g&&++m<50);return g?"#NUM!":d},XNPV:function(t,e,n){for(var r=0,i=0;i<e.length;i++)r+=e[i]/Math.pow(1+t,moment(n[i]).diff(moment(n[0]),"days")/365);return r},YIELD:function(){},YIELDDISC:function(){},YIELDMAT:function(){}},statistic:{AVEDEV:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;var t=utility.arrayMerge(arguments);return jStat.sum(jStat(t).subtract(jStat.mean(t)).abs()[0])/t.length},AVERAGE:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=0,i=0,a=0;a<e;a++)!0!==t[a]&&!1!==t[a]&&(i=parseFloat(t[a]),r+=isNaN(i)?0:i,n++);return r/n},AVERAGEA:function(){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.mean(utility.arrayMerge(arguments))},AVERAGEIF:function(range,criteria,average_range){average_range=void 0===average_range?range:average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},AVERAGEIFS:function(){for(var criteria=(arguments.length-1)/2,range=arguments[0],count=0,result=0,i=0;i<range.length;i++){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);fit&&(result+=range[i],count++)}return result/count},BETADIST:function(t,e,n,r,i,a){return void 0===jStat?data.ERRKEY.jStatRequired:(t=(t-(i=void 0===i?0:i))/((a=void 0===a?1:a)-i),r?jStat.beta.cdf(t,e,n):jStat.beta.pdf(t,e,n))},BETAINV:function(t,e,n,r,i){return void 0===jStat?data.ERRKEY.jStatRequired:(r=void 0===r?0:r,i=void 0===i?1:i,jStat.beta.inv(t,e,n)*(i-r)+r)},BINOMDIST:function(t,e,n,r){return void 0===jStat?data.ERRKEY.jStatRequired:r?jStat.binomial.cdf(t,e,n):jStat.binomial.pdf(t,e,n)},BINOMDISTRANGE:function(t,e,n,r){r=void 0===r?n:r;for(var i=0,a=n;a<=r;a++)i+=formula.math.COMBIN(t,a)*Math.pow(e,a)*Math.pow(1-e,t-a);return i},BINOMINV:function(t,e,n){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var r=0;r<=t;){if(jStat.binomial.cdf(r,t,e)>=n)return r;r++}},CHISQDIST:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:n?jStat.chisquare.cdf(t,e):jStat.chisquare.pdf(t,e)},CHISQDISTRT:function(t,e){},CHISQINV:function(t,e){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.chisquare.inv(t,e)},CHISQINVRT:function(){},CHISQTEST:function(){},CONFIDENCENORM:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.normalci(1,t,e,n)[1]-1},CONFIDENCET:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.tci(1,t,e,n)[1]-1},CORREL:function(){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.corrcoeff.apply(this,arguments)},COUNT:function(){return utility.arrayMerge(arguments).length},COUNTA:function(){var t=utility.arrayMerge(arguments);return t.length-formula.statistic.COUNTBLANK(t)},COUNTBLANK:function(){for(var t=utility.arrayMerge(arguments),e=0,n=0;n<t.length;n++)null!==t[n]&&""!==t[n]||e++;return e},COUNTIF:function(t,e){var n,r=0;for(n in t)t[n].match(new RegExp(e))&&r++;return r},COUNTIFS:function(){var criteria=(arguments.length-1)/2,range=arguments[0],result=0,i;for(i in range){for(var fit=!0,j=0;j<criteria;j++)eval(arguments[2*j+1][i]+arguments[2*j+2])||(fit=!1);result+=fit?1:0}return result},COUNTUNIQUE:function(){return utility.unique(utility.arrayMerge(arguments)).length},COVARIANCEP:function(t,e){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var n=jStat.mean(t),r=jStat.mean(e),i=0,a=t.length,o=0;o<a;o++)i+=(t[o]-n)*(e[o]-r);return i/a},COVARIANCES:function(){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.covariance.apply(this,arguments)},DEVSQ:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var t=utility.arrayMerge(arguments),e=jStat.mean(t),n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},EXPONDIST:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:n?jStat.exponential.cdf(t,e):jStat.exponential.pdf(t,e)},FDIST:function(t,e,n,r){return void 0===jStat?data.ERRKEY.jStatRequired:r?jStat.centralF.cdf(t,e,n):jStat.centralF.pdf(t,e,n)},FDISTRT:function(){},FINV:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.centralF.inv(t,e,n)},FINVRT:function(){},FTEST:function(){},FISHER:function(t){return Math.log((1+t)/(1-t))/2},FISHERINV:function(t){var e=Math.exp(2*t);return(e-1)/(e+1)},FORECAST:function(t,e,n){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var r=jStat.mean(n),i=jStat.mean(e),a=n.length,o=0,l=0,u=0;u<a;u++)o+=(n[u]-r)*(e[u]-i),l+=Math.pow(n[u]-r,2);var s=o/l;return i-s*r+s*t},FREQUENCY:function(t,e){for(var n=t.length,r=e.length,i=[],a=0;a<=r;a++){i[a]=0;for(var o=0;o<n;o++)0===a?t[o]<=e[0]&&(i[0]+=1):a<r?t[o]>e[a-1]&&t[o]<=e[a]&&(i[a]+=1):a===r&&t[o]>e[r-1]&&(i[r]+=1)}return i},GAMMA:function(){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.gammafn.apply(this,arguments)},GAMMADIST:function(t,e,n,r){},GAMMAINV:function(t,e,n){},GAMMALN:function(){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.gammaln.apply(this,arguments)},GAMMALNPRECISE:function(){},GAUSS:function(t){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.normal.cdf(t,0,1)-.5},GEOMEAN:function(){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.geomean(utility.arrayMerge(arguments))},GROWTH:function(t,e,n,r){var i;if(void 0===e)for(e=[],i=1;i<=t.length;i++)e.push(i);if(void 0===n)for(n=[],i=1;i<=t.length;i++)n.push(i);void 0===r&&(r=!0);var a,o,l=t.length,u=0,s=0,c=0,f=0;for(i=0;i<l;i++){var h=e[i],d=Math.log(t[i]);u+=h,s+=d,c+=h*d,f+=h*h}u/=l,s/=l,c/=l,f/=l,r?o=s-(a=(c-u*s)/(f-u*u))*u:(a=c/f,o=0);var m=[];for(i=0;i<n.length;i++)m.push(Math.exp(o+a*n[i]));return m},HARMEAN:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=0;r<e;r++)n+=1/t[r];return e/n},HYPGEOMDIST:function(t,e,n,r,i){function a(t,e,n,r){return formula.math.COMBIN(n,t)*formula.math.COMBIN(r-n,e-t)/formula.math.COMBIN(r,e)}return i?function(t,e,n,r){for(var i=0,o=0;o<=t;o++)i+=a(o,e,n,r);return i}(t,e,n,r):a(t,e,n,r)},INTERCEPT:function(t,e){return formula.statistic.FORECAST(0,t,e)},KURT:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var t=utility.arrayMerge(arguments),e=jStat.mean(t),n=t.length,r=0,i=0;i<n;i++)r+=Math.pow(t[i]-e,4);return n*(n+1)/((n-1)*(n-2)*(n-3))*(r/=Math.pow(jStat.stdev(t,!0),4))-3*(n-1)*(n-1)/((n-2)*(n-3))},LARGE:function(t,e){return(t=utility.objectToArray(t)).sort(function(t,e){return e-t})[e-1]},LINEST:function(t,e){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var n=jStat.mean(e),r=jStat.mean(t),i=e.length,a=0,o=0,l=0;l<i;l++)a+=(e[l]-n)*(t[l]-r),o+=Math.pow(e[l]-n,2);var u=a/o;return[u,r-u*n]},LOGEST:function(){},LOGNORMDIST:function(t,e,n,r){return void 0===jStat?data.ERRKEY.jStatRequired:r?jStat.lognormal.cdf(t,e,n):jStat.lognormal.pdf(t,e,n)},LOGNORMINV:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.lognormal.inv(t,e,n)},MAX:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=e>0?t[0]:0,r=0;r<e;r++)n=t[r]>n&&!0!==t[r]&&!1!==t[r]?t[r]:n;return n},MAXA:function(){var t=utility.arrayMerge(arguments);return t.length>0?Math.max.apply(Math,t):0},MEDIAN:function(){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.median(utility.arrayMerge(arguments))},MIN:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=e>0?t[0]:0,r=0;r<e;r++)n=t[r]<n&&!0!==t[r]&&!1!==t[r]?t[r]:n;return n},MINA:function(){var t=utility.arrayMerge(arguments);return t.length>0?Math.min.apply(Math,t):0},MODEMULT:function(){for(var t,e=utility.arrayMerge(arguments),n=e.length,r={},i=[],a=0,o=0;o<n;o++)r[t=e[o]]=r[t]?r[t]+1:1,r[t]>a&&(a=r[t],i=[]),r[t]===a&&(i[i.length]=t);return i},MODESNGL:function(){return formula.statistic.MODEMULT(utility.arrayMerge(arguments)).sort(function(t,e){return t-e})[0]},NEGBINOMDIST:function(t,e,n,r){return void 0===jStat?data.ERRKEY.jStatRequired:r?jStat.negbin.cdf(t,e,n):jStat.negbin.pdf(t,e,n)},NORMDIST:function(t,e,n,r){return void 0===jStat?data.ERRKEY.jStatRequired:isNaN(t)||isNaN(e)||isNaN(n)?"#VALUE!":n<=0?"#NUM!":r?jStat.normal.cdf(t,e,n):jStat.normal.pdf(t,e,n)},NORMINV:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.normal.inv(t,e,n)},NORMSDIST:function(t,e){return void 0===jStat?data.ERRKEY.jStatRequired:e?jStat.normal.cdf(t,0,1):jStat.normal.pdf(t,0,1)},NORMSINV:function(t){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.normal.inv(t,0,1)},PEARSON:function(t,e){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var n=jStat.mean(t),r=jStat.mean(e),i=t.length,a=0,o=0,l=0,u=0;u<i;u++)a+=(t[u]-n)*(e[u]-r),o+=Math.pow(t[u]-n,2),l+=Math.pow(e[u]-r,2);return a/Math.sqrt(o*l)},PERCENTILEEXC:function(t,e){var n=(t=t.sort(function(t,e){return t-e})).length;if(e<1/(n+1)||e>1-1/(n+1))return"#NUM!";var r=e*(n+1)-1,i=Math.floor(r);return utility.cleanFloat(r===i?t[r]:t[i]+(r-i)*(t[i+1]-t[i]))},PERCENTILEINC:function(t,e){var n=e*((t=t.sort(function(t,e){return t-e})).length-1),r=Math.floor(n);return utility.cleanFloat(n===r?t[n]:t[r]+(n-r)*(t[r+1]-t[r]))},PERCENTRANKEXC:function(t,e,n){t=t.sort(function(t,e){return t-e});var r=utility.unique(t),i=t.length,a=r.length;n=void 0===n?3:n;for(var o=Math.pow(10,n),l=0,u=!1,s=0;!u&&s<a;)e===r[s]?(l=(t.indexOf(r[s])+1)/(i+1),u=!0):e>=r[s]&&(e<r[s+1]||s===a-1)&&(l=(t.indexOf(r[s])+1+(e-r[s])/(r[s+1]-r[s]))/(i+1),u=!0),s++;return Math.floor(l*o)/o},PERCENTRANKINC:function(t,e,n){t=t.sort(function(t,e){return t-e});var r=utility.unique(t),i=t.length,a=r.length;n=void 0===n?3:n;for(var o=Math.pow(10,n),l=0,u=!1,s=0;!u&&s<a;)e===r[s]?(l=t.indexOf(r[s])/(i-1),u=!0):e>=r[s]&&(e<r[s+1]||s===a-1)&&(l=(t.indexOf(r[s])+(e-r[s])/(r[s+1]-r[s]))/(i-1),u=!0),s++;return Math.floor(l*o)/o},PERMUT:function(t,e){return formula.math.FACT(t)/formula.math.FACT(t-e)},PERMUTATIONA:function(t,e){return Math.pow(t,e)},PHI:function(t){return Math.exp(-.5*t*t)/data.SQRT2PI},POISSONDIST:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:n?jStat.poisson.cdf(t,e):jStat.poisson.pdf(t,e)},PROB:function(t,e,n,r){if(void 0===n)return 0;if(n===(r=void 0===r?n:r))return t.indexOf(n)>=0?e[t.indexOf(n)]:0;for(var i=t.sort(function(t,e){return t-e}),a=i.length,o=0,l=0;l<a;l++)i[l]>=n&&i[l]<=r&&(o+=e[t.indexOf(i[l])]);return o},QUARTILEEXC:function(t,e){switch(e){case 1:return formula.statistic.PERCENTILEEXC(t,.25);case 2:return formula.statistic.PERCENTILEEXC(t,.5);case 3:return formula.statistic.PERCENTILEEXC(t,.75);default:return"#NUM!"}},QUARTILEINC:function(t,e){switch(e){case 1:return formula.statistic.PERCENTILEINC(t,.25);case 2:return formula.statistic.PERCENTILEINC(t,.5);case 3:return formula.statistic.PERCENTILEINC(t,.75);default:return"#NUM!"}},RANKAVG:function(t,e,n){var r=(n=void 0!==n&&n)?function(t,e){return t-e}:function(t,e){return e-t};e=e.sort(r);var i=utility.countIn(e,t);return i>1?(2*e.indexOf(t)+i+1)/2:e.indexOf(t)+1},RANKEQ:function(t,e,n){var r=(n=void 0!==n&&n)?function(t,e){return t-e}:function(t,e){return e-t};return(e=e.sort(r)).indexOf(t)+1},RSQ:function(t,e){return Math.pow(formula.statistic.PEARSON(t,e),2)},SKEW:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var t=utility.arrayMerge(arguments),e=jStat.mean(t),n=t.length,r=0,i=0;i<n;i++)r+=Math.pow(t[i]-e,3);return n*r/((n-1)*(n-2)*Math.pow(jStat.stdev(t,!0),3))},SKEWP:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var t=utility.arrayMerge(arguments),e=jStat.mean(t),n=t.length,r=0,i=0,a=0;a<n;a++)i+=Math.pow(t[a]-e,3),r+=Math.pow(t[a]-e,2);return r/=n,(i/=n)/Math.pow(r,1.5)},SLOPE:function(t,e){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var n=jStat.mean(e),r=jStat.mean(t),i=e.length,a=0,o=0,l=0;l<i;l++)a+=(e[l]-n)*(t[l]-r),o+=Math.pow(e[l]-n,2);return a/o},SMALL:function(t,e){return t.sort(function(t,e){return t-e})[e-1]},STANDARDIZE:function(t,e,n){return(t-e)/n},STDEVA:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=jStat.mean(t),i=0;i<e;i++)n+=Math.pow(t[i]-r,2);return Math.sqrt(n/(e-1))},STDEVP:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=0,i=formula.statistic.AVERAGE(t),a=0;a<e;a++)!0!==t[a]&&!1!==t[a]&&(n+=Math.pow(t[a]-i,2),r++);return Math.sqrt(n/r)},STDEVPA:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=jStat.mean(t),i=0;i<e;i++)n+=Math.pow(t[i]-r,2);return Math.sqrt(n/e)},STDEVS:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=0,i=formula.statistic.AVERAGE(t),a=0;a<e;a++)!0!==t[a]&&!1!==t[a]&&(n+=Math.pow(t[a]-i,2),r++);return Math.sqrt(n/(r-1))},STEYX:function(t,e){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var n=jStat.mean(e),r=jStat.mean(t),i=e.length,a=0,o=0,l=0,u=0;u<i;u++)a+=Math.pow(t[u]-r,2),o+=(e[u]-n)*(t[u]-r),l+=Math.pow(e[u]-n,2);return Math.sqrt((a-o*o/l)/(i-2))},TDIST:function(t,e,n){return void 0===jStat?data.ERRKEY.jStatRequired:n?jStat.studentt.cdf(t,e):jStat.studentt.pdf(t,e)},TDIST2T:function(){},TDISTRT:function(){},TINV:function(t,e){return void 0===jStat?data.ERRKEY.jStatRequired:jStat.studentt.inv(t,e)},TINV2T:function(){},TTEST:function(){},TREND:function(){},TRIMMEAN:function(t,e){if(void 0===jStat)return data.ERRKEY.jStatRequired;t.length;var n=formula.math.FLOOR(t.length*e,2)/2;return jStat.mean(utility.initial(utility.rest(t.sort(function(t,e){return t-e}),n),n))},VARA:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=jStat.mean(t),i=0;i<e;i++)n+=Math.pow(t[i]-r,2);return n/(e-1)},VARP:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=0,i=formula.statistic.AVERAGE(t),a=0;a<e;a++)!0!==t[a]&&!1!==t[a]&&(n+=Math.pow(t[a]-i,2),r++);return n/r},VARPA:function(){if(void 0===jStat)return data.ERRKEY.jStatRequired;for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=jStat.mean(t),i=0;i<e;i++)n+=Math.pow(t[i]-r,2);return n/e},VARS:function(){for(var t=utility.arrayMerge(arguments),e=t.length,n=0,r=0,i=formula.statistic.AVERAGE(t),a=0;a<e;a++)!0!==t[a]&&!1!==t[a]&&(n+=Math.pow(t[a]-i,2),r++);return n/(r-1)},WEIBULLDIST:function(t,e,n,r){return r?1-Math.exp(-Math.pow(t/n,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/n,e))*e/Math.pow(n,e)},ZTEST:function(t,e,n){var r=t.length,i=void 0===n?formula.statistic.STDEVS(t):n;return 1-formula.statistic.NORMSDIST((formula.statistic.AVERAGE(t)-e)/(i/Math.sqrt(r)),formula.logical.TRUE)}},logical:{AND:function(){for(var t=!0,e=0;e<arguments.length;e++)arguments[e]||(t=!1);return t},CHOOSE:function(){var t=arguments[0];return void 0===arguments[t]?"#NUM!":arguments[t]},FALSE:function(){return!1},IF:function(t,e,n){return t?void 0===e||e:void 0===n||n},IFERROR:function(t,e){return data.ERROR.indexOf(t)>=0?e:t},IFNA:function(t,e){return"#N/A"===t?e:t},NOT:function(t){return!t},OR:function(){for(var t=!1,e=0;e<arguments.length;e++)arguments[e]&&(t=!0);return t},SWITCH:function(){var t;if(arguments.length>0){var e=arguments[0],n=arguments.length-1,r=Math.floor(n/2),i=!1,a=n%2==0?null:arguments[arguments.length-1];if(r)for(var o=0;o<r;o++)if(e==arguments[2*o+1]){t=arguments[2*o+2],i=!0;break}!i&&a&&(t=a)}return t},TRUE:function(){return!0},XOR:function(){for(var t=0,e=0;e<arguments.length;e++)arguments[e]&&t++;return!!(1&Math.floor(Math.abs(t)))},NULL:function(){return null}},geometry:{},text:{CONCAT:function(){var t,e="";for(t in arguments)"object"==typeof arguments[t]?e+=formula.text.CONCAT.apply(this,arguments[t]):e+=arguments[t];return e},CHAR:function(t){return String.fromCharCode(t)},CLEAN:function(t){return t.replace(/[\0-\x1F]/g,"")},CODE:function(t){return t.charCodeAt(0)},CONCATENATE:function(){for(var t="",e=0;e<arguments.length;e++)null!==arguments[e]&&void 0!==arguments[e]&&(t+=arguments[e]);return t},DOLLAR:function(t,e){if(void 0===numeral)return"#NAME?";var n="";return(e=void 0===e?2:e)<=0?(t=Math.round(t*Math.pow(10,e))/Math.pow(10,e),n="($0,0)"):e>0&&(n="($0,0."+new Array(e+1).join("0")+")"),numeral(t).format(n)},EXACT:function(t,e){return t===e},FIND:function(t,e,n){return n=void 0===n?0:n,e?e.indexOf(t,n-1)+1:null},FIXED:function(t,e,n){if(void 0===numeral)return"#NAME?";e=void 0===e?2:e;var r=(n=void 0!==n&&n)?"0":"0,0";return e<=0?t=Math.round(t*Math.pow(10,e))/Math.pow(10,e):e>0&&(r+="."+new Array(e+1).join("0")),numeral(t).format(r)},HTML2TEXT:function(t){var e="";return t&&(t instanceof Array?t.forEach(function(t){""!==e&&(e+="\n"),e+=t.replace(/<(?:.|\n)*?>/gm,"")}):e=t.replace(/<(?:.|\n)*?>/gm,"")),e},HUMANIZE:function(t){if(t instanceof Date){var e=moment(t);return e.hours()||e.minutes()||e.seconds()?e.format("dddd, MMMM Do YYYY, h:mm:ss"):e.format("dddd, MMMM Do YYYY")}return t},JOIN:function(t,e){return t.join(e)},LEFT:function(t,e){return e=void 0===e?1:e,t?t.substring(0,e):null},LEN:function(t){return(t+"").length},LOWER:function(t){return t?t.toLowerCase():t},MID:function(t,e,n){return t.substring(e-1,n)},NUMBERVALUE:function(t,e,n){return e=void 0===e?".":e,n=void 0===n?",":n,Number(t.replace(e,".").replace(n,""))},PROPER:function(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},REGEXEXTRACT:function(t,e){var n=t.match(new RegExp(e));return n?n[0]:null},REGEXMATCH:function(t,e,n){var r=t.match(new RegExp(e));return n?r:!!t.match(new RegExp(e))},REGEXREPLACE:function(t,e,n){return t.replace(new RegExp(e),n)},REPLACE:function(t,e,n,r){return t.substr(0,e-1)+r+t.substr(e-1+n)},REPT:function(t,e){return new Array(e+1).join(t)},RIGHT:function(t,e){return e=void 0===e?1:e,t?t.substring(t.length-e):null},ROMAN:function(t){for(var e=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",i=3;i--;)r=(n[+e.pop()+10*i]||"")+r;return new Array(+e.join("")+1).join("M")+r},SEARCH:function(t,e,n){return n=void 0===n?0:n,e.toLowerCase().indexOf(t.toLowerCase(),n-1)+1},SPLIT:function(t,e){return(t=$.trim(t)).split(t,e||/\s+/)},SUBSTITUTE:function(t,e,n,r){if(!(t&&e&&n))return t;if(void 0===r)return t.replace(new RegExp(e,"g"),n);for(var i=0,a=0;t.indexOf(e,i)>0;)if(i=t.indexOf(e,i+1),++a===r)return t.substring(0,i)+n+t.substring(i+e.length)},T:function(t){return"string"==typeof t?t:null},TEXT:function(t,e){if(void 0===numeral)return"#NAME?";var n="";if(t)if(t instanceof Object)try{n=JSON.stringify(t)}catch(t){}else"string"==typeof t?n=e?e.indexOf("0")>=0?numeral(t).format(e):moment(new Date(t)).format(e):t:t.toString&&"function"==typeof t.toString&&(n=t.toString());return n},TRIM:function(t){return $.trim(t)},UNICHAR:function(t){return formula.text.CHAR(t)},UNICODE:function(t){return formula.text.CODE(t)},UPPER:function(t){return t.toUpperCase()},VALUE:function(t){return void 0===numeral?"#NAME?":numeral().unformat(t)}},trigonometry:{},general:{VLOOKUP:function(t,e,n,r){var i,a,o;if("Object"==e.constructor.name&&(e=utility.rangeToTable(e)),a=e.length,o=e[0].length,n-=1,r=void 0!==r&&r,n>o-1)return"#REF!";if(n<0)return"#VALUE!";if(0==r){for(i=0;i<a;i++)if(t==e[i][0])return e[i][n];return"#N/A!"}var l,u={};for(i=0;i<a;i++){if(t==e[i][0])return e[i][n];(l=e[i][0]-t)<0&&(u[i]=l)}u.length;var s=null,c=null;for(var f in u)null==s?(s=u[f],c=f):c=(s=s>u[f]?s:u[f])>u[f]?c:f;return null==c?"#N/A!":e[c][n]},HLOOKUP:function(t,e,n,r){return e=utility.rangeToTable(e),e=utility.transposeTable(e),formula.general.VLOOKUP(t,e,n,r)},LOOKUP:function(t,e,n){var r,i,a,o,l,u,s=[];if(n=void 0!==n&&n,"Object"==e.constructor.name&&(i=(e=utility.objectToArray(e)).length),"Object"==n.constructor.name&&(n=utility.objectToArray(n)).length,t<Math.min.apply(Math,e))return"#N/A!";for(r=0;r<i;r++){if(t==e[r])return n?n[r]:e[r];s[r]=t-e[r]}for(a=s.length,l=Math.max.apply(Math,s),o=0;o<a;o++)s[o]<0&&(s[o]=l);return u=Math.min.apply(Math,s),r=s.indexOf(u),n?n[r]:e[r]},SERVER:function(){if(null==this.config.ajaxUrl)return data.ERRKEY.ajaxUrlRequired;for(var t,e=arguments[0],n={},r=1;r<arguments.length;r++)n["params["+r+"]"]=arguments[r];return n.function=e,$.ajax({url:this.config.ajaxUrl,method:this.config.ajaxMethod,data:n,async:!1,success:function(e){t=e},error:function(e){t=data.ERRKEY.sendRequestError}}),t},GRAPH:function(t,e){for(var n,r,i={},a=this.getActiveCell().el,o={},l=(e=void 0===e?[]:e,0);l<e.length;l++)i[(n=e[l].split("="))[0]]=n[1];switch(a.height()||a.css("height","300px"),a.width||a.css("width","300px"),i.type){case"bar":r=utility.rangeToTable(t),i.reverse,"true"==i.reverse&&r.reverse(),o.series={bars:{show:!0,barWidth:.6,align:"center"},stack:!0},void 0!==i.bar_orientation&&"horizontal"==i.bar_orientation&&(o.series.bars.horizontal=!0);break;case"pie":r=utility.objectToArray(t),o.series={pie:{show:!0,radius:.8}},o.legend={show:!1};break;case"doughnut":case"donut":r=utility.objectToArray(t),o.series={pie:{show:!0,innerRadius:.5,radius:.8}},o.legend={show:!1};break;default:r=utility.rangeToTable(t),i.reverse,"true"==i.reverse&&r.reverse()}if(void 0!==i.orientation&&"vertical"==i.orientation&&(r=utility.transposeTable(r)),void 0!==i.label){var u=this.evaluate(i.label),s=(u=utility.objectToArray(u),r.length);for(f=0;f<s;f++)for(c=r[f].length,h=0;h<c;h++)t=r[f][h],r[f][h]=[u[h],t];o.xaxis={mode:"categories",tickLength:0}}else{var c,f,h;s=r.length;for(f=0;f<s;f++)for(c=r[f].length,h=0;h<c;h++)t=r[f][h],void 0!==i.bar_orientation&&"horizontal"==i.bar_orientation?r[f][h]=[t,h]:r[f][h]=[h,t]}if(void 0!==i.legend){for(var d=this.evaluate(i.legend),m=(d=utility.objectToArray(d),[]),g=0;g<r.length;g++)m.push({label:d[g],data:r[g]});r=m}return void 0!==i.show_x_axis&&"false"==i.show_x_axis&&(o.xaxis=o.xaxis||{},o.xaxis.show=!1),void 0!==i.show_y_axis&&"false"==i.show_y_axis&&(o.yaxis=o.yaxis||{},o.yaxis.show=!1),o.grid={backgroundColor:{colors:["#fff","#eee"]},borderWidth:{top:0,right:0,bottom:0,left:0}},setTimeout(function(){$.plot(a,r,o)},100),!1}},engineering:{BIN2DEC:function(t){if(!utility.isValidBinary(t))return"#NUM!";var e=parseInt(t,2),n=t.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:e},BIN2HEX:function(t,e){if(!utility.isValidBinary(t))return"#NUM!";var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var r=parseInt(t,2).toString(16);return void 0===e?r:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=r.length?utility.repeat("0",e-r.length)+r:"#NUM!"},BIN2OCT:function(t,e){if(!utility.isValidBinary(t))return"#NUM!";var n=t.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var r=parseInt(t,2).toString(8);return void 0===e?r:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=r.length?utility.repeat("0",e-r.length)+r:"#NUM!"},BITAND:function(t,e){return t=parseFloat(t,10),e=parseFloat(e,10),isNaN(t)||isNaN(e)?"#VALUE!":t<0||e<0?"#NUM!":Math.floor(t)!==t||Math.floor(e)!==e?"#NUM!":t>0xffffffffffff||e>0xffffffffffff?"#NUM!":t&e},BITLSHIFT:function(t,e){return t=parseFloat(t,10),e=parseFloat(e,10),isNaN(t)||isNaN(e)?"#VALUE!":t<0?"#NUM!":Math.floor(t)!==t?"#NUM!":t>0xffffffffffff?"#NUM!":Math.abs(e)>53?"#NUM!":e>=0?t<<e:t>>-e},BITOR:function(t,e){return t=parseFloat(t,10),e=parseFloat(e,10),isNaN(t)||isNaN(e)?"#VALUE!":t<0||e<0?"#NUM!":Math.floor(t)!==t||Math.floor(e)!==e?"#NUM!":t>0xffffffffffff||e>0xffffffffffff?"#NUM!":t|e},BITRSHIFT:function(t,e){return t=parseFloat(t,10),e=parseFloat(e,10),isNaN(t)||isNaN(e)?"#VALUE!":t<0?"#NUM!":Math.floor(t)!==t?"#NUM!":t>0xffffffffffff?"#NUM!":Math.abs(e)>53?"#NUM!":e>=0?t>>e:t<<-e},BITXOR:function(t,e){return t=parseFloat(t,10),e=parseFloat(e,10),isNaN(t)||isNaN(e)?"#VALUE!":t<0||e<0?"#NUM!":Math.floor(t)!==t||Math.floor(e)!==e?"#NUM!":t>0xffffffffffff||e>0xffffffffffff?"#NUM!":t^e},COMPLEX:function(t,e,n){if(isNaN(t)||isNaN(e))return"#VALUE!";if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return"#VALUE!";if(0===t&&0===e)return 0;if(0===t)return 1===e?n:e.toString()+n;if(0===e)return t.toString();var r=e>0?"+":"";return t.toString()+r+(1===e?n:e.toString()+n)},CONVERT:function(t,e,n){if(isNaN(t))return"#VALUE!";for(var r,i=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["Ã¥ngstrÃ¶m","Ã…",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic Ã¥ngstrÃ¶m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","Â°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["Å“rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Î©",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestÃ¤rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square Ã¥ngstrÃ¶m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],a={Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},o={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},l=null,u=null,s=e,c=n,f=1,h=1,d=0;d<i.length;d++)r=null===i[d][2]?[]:i[d][2],(i[d][1]===s||r.indexOf(s)>=0)&&(l=i[d]),(i[d][1]===c||r.indexOf(c)>=0)&&(u=i[d]);if(null===l){var m=a[e.substring(0,2)],g=o[e.substring(0,1)];"da"===e.substring(0,2)&&(g=["dekao",10,"da"]),m?(f=m[2],s=e.substring(2)):g&&(f=g[1],s=e.substring(g[2].length));for(var M=0;M<i.length;M++)r=null===i[M][2]?[]:i[M][2],(i[M][1]===s||r.indexOf(s)>=0)&&(l=i[M])}if(null===u){var p=a[n.substring(0,2)],v=o[n.substring(0,1)];"da"===n.substring(0,2)&&(v=["dekao",10,"da"]),p?(h=p[2],c=n.substring(2)):v&&(h=v[1],c=n.substring(v[2].length));for(var E=0;E<i.length;E++)r=null===i[E][2]?[]:i[E][2],(i[E][1]===c||r.indexOf(c)>=0)&&(u=i[E])}return null===l||null===u?"#N/A":l[3]!==u[3]?"#N/A":t*l[6]*f/(u[6]*h)},DEC2BIN:function(t,e){if(isNaN(t))return"#VALUE!";if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return"#NUM!";if(t<0)return"1"+utility.repeat("0",9-(512+t).toString(2).length)+(512+t).toString(2);var n=parseInt(t,10).toString(2);return void 0===e?n:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=n.length?utility.repeat("0",e-n.length)+n:"#NUM!"},DEC2HEX:function(t,e){if(isNaN(t))return"#VALUE!";if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return"#NUM!";if(t<0)return(1099511627776+t).toString(16);var n=parseInt(t,10).toString(16);return void 0===e?n:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=n.length?utility.repeat("0",e-n.length)+n:"#NUM!"},DEC2OCT:function(t,e){if(isNaN(t))return"#VALUE!";if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return"#NUM!";if(t<0)return(1073741824+t).toString(8);var n=parseInt(t,10).toString(8);return void 0===e?n:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=n.length?utility.repeat("0",e-n.length)+n:"#NUM!"},DELTA:function(t,e){return e=void 0===e?0:e,isNaN(t)||isNaN(e)?"#VALUE!":t===e?1:0},ERF:function(t,e){return e=void 0===e?0:e,isNaN(t)||isNaN(e)?"#VALUE!":jStat.erf(t)},ERFC:function(t){return isNaN(t)?"#VALUE!":jStat.erfc(t)},ERFCPRECISE:function(){},ERFPRECISE:function(){},GESTEP:function(t,e){return e=void 0===e?0:e,isNaN(t)||isNaN(e)?"#VALUE!":t>=e?1:0},HEX2BIN:function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return"#NUM!";var n=10===t.length&&"f"===t.substring(0,1).toLowerCase(),r=n?parseInt(t,16)-1099511627776:parseInt(t,16);if(r<-512||r>511)return"#NUM!";if(n)return"1"+utility.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return void 0===e?i:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=i.length?utility.repeat("0",e-i.length)+i:"#NUM!"},HEX2DEC:function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return"#NUM!";var e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},HEX2OCT:function(t,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return"#NUM!";var n=parseInt(t,16);if(n>536870911&&n<0xffe0000000)return"#NUM!";if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var r=n.toString(8);return void 0===e?r:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=r.length?utility.repeat("0",e-r.length)+r:"#NUM!"},IMABS:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":Math.sqrt(Math.pow(e,2)+Math.pow(n,2))},IMAGINARY:function(t){if(0===t||"0"===t)return 0;if(["i","j"].indexOf(t)>=0)return 1;var e=(t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var r=t.substring(t.length-1,t.length),i="i"===r||"j"===r;return e>=0||n>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?"#NUM!":Number(t.substring(e+1,t.length-1)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?"#NUM!":-Number(t.substring(n+1,t.length-1)):"#NUM!":i?isNaN(t.substring(0,t.length-1))?"#NUM!":t.substring(0,t.length-1):isNaN(t)?"#NUM!":0},IMARGUMENT:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":0===e&&0===n?"#DIV/0!":0===e&&n>0?Math.PI/2:0===e&&n<0?-Math.PI/2:0===n&&e>0?0:0===n&&e<0?-Math.PI:e>0?Math.atan(n/e):e<0&&n>=0?Math.atan(n/e)+Math.PI:Math.atan(n/e)-Math.PI},IMCONJUGATE:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":0!==n?formula.engineering.COMPLEX(e,-n,r):t},IMCOS:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.COMPLEX(Math.cos(e)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(e)*(Math.exp(n)-Math.exp(-n))/2,r)},IMCOSH:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.COMPLEX(Math.cos(n)*(Math.exp(e)+Math.exp(-e))/2,Math.sin(n)*(Math.exp(e)-Math.exp(-e))/2,r)},IMCOT:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.IMDIV(formula.engineering.IMCOS(t),formula.engineering.IMSIN(t))},IMCSC:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.IMDIV("1",formula.engineering.IMSIN(t))},IMCSCH:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.IMDIV("1",formula.engineering.IMSINH(t))},IMDIV:function(t,e){var n=formula.engineering.IMREAL(t),r=formula.engineering.IMAGINARY(t),i=formula.engineering.IMREAL(e),a=formula.engineering.IMAGINARY(e),o=t.substring(t.length-1),l=t.substring(t.length-1),u="i";if("j"===o?u="j":"j"===l&&(u="j"),"#NUM!"===n||"#NUM!"===r||"#NUM!"===i||"#NUM!"===a)return"#NUM!";if(0===i&&0===a)return"#NUM!";var s=i*i+a*a;return formula.engineering.COMPLEX((n*i+r*a)/s,(r*i-n*a)/s,u)},IMEXP:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);if(r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n)return"#NUM!";var i=Math.exp(e);return formula.engineering.COMPLEX(i*Math.cos(n),i*Math.sin(n),r)},IMLN:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.COMPLEX(Math.log(Math.sqrt(e*e+n*n)),Math.atan(n/e),r)},IMLOG10:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.COMPLEX(Math.log(Math.sqrt(e*e+n*n))/Math.log(10),Math.atan(n/e)/Math.log(10),r)},IMLOG2:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.COMPLEX(Math.log(Math.sqrt(e*e+n*n))/Math.log(2),Math.atan(n/e)/Math.log(2),r)},IMPOWER:function(t,e){if(isNaN(e))return"#VALUE!";var n=formula.engineering.IMREAL(t),r=formula.engineering.IMAGINARY(t),i=t.substring(t.length-1);if(i="i"===i||"j"===i?i:"i","#NUM!"===n||"#NUM!"===r)return"#NUM!";var a=Math.pow(formula.engineering.IMABS(t),e),o=formula.engineering.IMARGUMENT(t);return formula.engineering.COMPLEX(a*Math.cos(e*o),a*Math.sin(e*o),i)},IMPRODUCT:function(){for(var t=arguments[0],e=1;e<arguments.length;e++){var n=formula.engineering.IMREAL(t),r=formula.engineering.IMAGINARY(t),i=formula.engineering.IMREAL(arguments[e]),a=formula.engineering.IMAGINARY(arguments[e]);if("#NUM!"===n||"#NUM!"===r||"#NUM!"===i||"#NUM!"===a)return"#NUM!";t=formula.engineering.COMPLEX(n*i-r*a,n*a+r*i)}return t},IMREAL:function(t){if(0===t||"0"===t)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var e=t.indexOf("+"),n=t.indexOf("-");0===e&&(e=t.indexOf("+",1)),0===n&&(n=t.indexOf("-",1));var r=t.substring(t.length-1,t.length),i="i"===r||"j"===r;return e>=0||n>=0?i?e>=0?isNaN(t.substring(0,e))||isNaN(t.substring(e+1,t.length-1))?"#NUM!":Number(t.substring(0,e)):isNaN(t.substring(0,n))||isNaN(t.substring(n+1,t.length-1))?"#NUM!":Number(t.substring(0,n)):"#NUM!":i?isNaN(t.substring(0,t.length-1))?"#NUM!":0:isNaN(t)?"#NUM!":t},IMSEC:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.IMDIV("1",formula.engineering.IMCOS(t))},IMSECH:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.IMDIV("1",formula.engineering.IMCOSH(t))},IMSIN:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.COMPLEX(Math.sin(e)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(e)*(Math.exp(n)-Math.exp(-n))/2,r)},IMSINH:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);return r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.COMPLEX(Math.cos(n)*(Math.exp(e)-Math.exp(-e))/2,Math.sin(n)*(Math.exp(e)+Math.exp(-e))/2,r)},IMSQRT:function(t){var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t),r=t.substring(t.length-1);if(r="i"===r||"j"===r?r:"i","#NUM!"===e||"#NUM!"===n)return"#NUM!";var i=Math.sqrt(formula.engineering.IMABS(t)),a=formula.engineering.IMARGUMENT(t);return formula.engineering.COMPLEX(i*Math.cos(a/2),i*Math.sin(a/2),r)},IMSUB:function(t,e){var n=formula.engineering.IMREAL(t),r=formula.engineering.IMAGINARY(t),i=formula.engineering.IMREAL(e),a=formula.engineering.IMAGINARY(e),o=t.substring(t.length-1),l=t.substring(t.length-1),u="i";return"j"===o?u="j":"j"===l&&(u="j"),"#NUM!"===n||"#NUM!"===r||"#NUM!"===i||"#NUM!"===a?"#NUM!":formula.engineering.COMPLEX(n-i,r-a,u)},IMSUM:function(){for(var t=arguments[0],e=1;e<arguments.length;e++){var n=formula.engineering.IMREAL(t),r=formula.engineering.IMAGINARY(t),i=formula.engineering.IMREAL(arguments[e]),a=formula.engineering.IMAGINARY(arguments[e]);if("#NUM!"===n||"#NUM!"===r||"#NUM!"===i||"#NUM!"===a)return"#NUM!";t=formula.engineering.COMPLEX(n+i,r+a)}return t},IMTAN:function(t){if(!0===t||!1===t)return"#VALUE!";var e=formula.engineering.IMREAL(t),n=formula.engineering.IMAGINARY(t);return"#NUM!"===e||"#NUM!"===n?"#NUM!":formula.engineering.IMDIV(formula.engineering.IMSIN(t),formula.engineering.IMCOS(t))},OCT2BIN:function(t,e){if(!/^[0-7]{1,10}$/.test(t))return"#NUM!";var n=10===t.length&&"7"===t.substring(0,1),r=n?parseInt(t,8)-1073741824:parseInt(t,8);if(r<-512||r>511)return"#NUM!";if(n)return"1"+utility.repeat("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return void 0===e?i:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=i.length?utility.repeat("0",e-i.length)+i:"#NUM!"},OCT2DEC:function(t){if(!/^[0-7]{1,10}$/.test(t))return"#NUM!";var e=parseInt(t,8);return e>=536870912?e-1073741824:e},OCT2HEX:function(t,e){if(!/^[0-7]{1,10}$/.test(t))return"#NUM!";var n=parseInt(t,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var r=n.toString(16);return void 0===e?r:isNaN(e)?"#VALUE!":e<0?"#NUM!":(e=Math.floor(e))>=r.length?utility.repeat("0",e-r.length)+r:"#NUM!"}},user_defined:{}},utility={toChr:function(t){var e="";for(t-=1;t>=0;)e=String.fromCharCode(t%26+97)+e,t=Math.floor(t/26)-1;return e.toUpperCase()},toNum:function(t){t=t.split("");var e,n,r="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),i=0;for(e=0,n=t.length-1;e<t.length;e+=1,n-=1)i+=Math.pow(r.length,n)*(r.indexOf(t[e])+1);return i},cellRange:function(t,e){var n,r,i,a=/[A-Z]+/,o=/[0-9]+/,l=t.toUpperCase(),u=e.toUpperCase(),s=this.toNum(l.match(a)[0]),c=this.toNum(u.match(a)[0]),f=parseInt(l.match(o)[0],10),h=parseInt(u.match(o)[0],10),d=[];if(s<c)for(i=s;i<=c;i++)if(f<h)for(r=f;r<=h;r++)n=this.toChr(i)+r,d.push(n);else for(r=f;r>=h;r--)n=this.toChr(i)+r,d.push(n);else for(i=s;i>=c;i--)if(f<h)for(r=f;r<=h;r++)n=this.toChr(i)+r,d.push(n);else for(r=f;r>=h;r--)n=this.toChr(i)+r,d.push(n);return d},isValidBinary:function(t){return/^[01]{1,10}$/.test(t)},strRepeat:function(t,e){if(e<1)return"";for(var n="";e>0;)1&e&&(n+=t),e>>=1,t+=t;return n},repeat:function(t,e,n){if(null==t)return"";if(e=~~e,null==n)return this.strRepeat(String(t),e);for(var r=[];e>0;r[--e]=t);return r.join(n)},unique:function(t){return t.reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[])},initial:function(t,e,n){return Array.prototype.slice.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},rest:function(t,e,n){return Array.prototype.slice.call(t,null==e||n?1:e)},arrayMerge:function(t){var e,n,r=[];for(n=0;n<t.length;n++)if("object"==typeof t[n])for(e in t[n])""!==$.trim(t[n][e])&&(r=r.concat(t[n][e]));else""!==$.trim(r.concat(t[n]))&&(r=r.concat(t[n]));return r},toArray:function(t){return Array.prototype.slice.call(t,0)},objectToArray:function(t){var e,n=[];for(e in t)n.push(t[e]);return n},trimEmptyCell:function(t){var e={};for(var n in t)""!==$.trim(t[n])&&(e[n]=t[n]);return e},cleanFloat:function(t){var e=Math.pow(10,14);return Math.round(t*e)/e},countIn:function(t,e){for(var n=0,r=0;r<t.length;r++)t[r]===e&&n++;return n},rangeToTable:function(t){var e,n,r=0,i=/[A-Z]+/,a=/[0-9]+/,o=[],l=[];for(e in t)n=this.toNum(e.match(i)[0])-1,void 0===o[r=parseInt(e.match(a)[0],10)-1]&&(o[r]=[]),o[r][n]=t[e];var u,s=0,c=o.length;for(r=0;r<c;r++)if(void 0!==o[r]){for(u=o[r].length,void 0===l[s]&&(l[s]=[]),n=0;n<u;n++)void 0!==o[r][n]&&l[s].push(o[r][n]);s++}return l},transposeTable:function(t){var e,n,r,i,a;for(r=t.length,a=[],e=0;e<r;e++)for(i=t[e].length,n=0;n<i;n++)void 0===a[n]&&(a[n]=[]),a[n].push(t[e][n]);return a}},data={MEMOIZED_FACT:[],SQRT2PI:2.5066282746310002,WEEK_STARTS:[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],WEEK_TYPES:[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],WEEKEND_TYPES:[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],DAY_NAME:["Sunday","Monday","Thuesday","Wednesday","Thursday","Friday","Saturday"],ERROR:["#DIV/0!","#N/A","#NAME?","#NUM!","#NULL!","#REF!","#VALUE!","#ERROR!","#ERROR_MOMENT_JS_REQUIRED!","#ERROR_JSTAT_JS_REQUIRED!","#ERROR_AJAX_URL_REQUIRED!","#ERROR_SEND_REQUEST!","#UNDEFINED_VARIABLE!"],ERRKEY:{jStatRequired:"#ERROR_JSTAT_JS_REQUIRED!",momentRequired:"#ERROR_MOMENT_JS_REQUIRED!",ajaxUrlRequired:"#ERROR_AJAX_URL_REQUIRED!",sendRequestError:"#ERROR_SEND_REQUEST!"},VARIABLE:{},SELF_RENDER_FORMULA:["GRAPH"]};function cell(t,e,n){this.sheet=t,this.value=null,this.formattedValue=null,this.computedValue=null,this.floatValue=null,this.affected=!1,this.processed=!1,this.dependencies={},this.dependant={},this.conditionalStyle=!1,this.address="",this.remoteDependency=!1,this.isCheckbox=!1,void 0!==e?this.el=$(e):(this.el=!1,this.address=void 0!==n?n:""),this.init()}function sheet(t,e,n){this.identifier=t,this.el=$(e),this.lang="en",this.cells={},this.variables={},this.config=$.extend({},defaultConfig,n),this.counter=1,this.relatedSheet=!1,this.elementId=this.el.attr("id"),this.dependant={},this.dependencies={},this.calculated=!1,this.calculating=!1,this.activeCell=null,this.totalCell=0,this.affectedCell=[],this.init()}cell.fx=cell.prototype,cell.fx.init=function(){var t=this.el?this.el.attr("data-cell"):this.address,e=this.el?this.el.attr("data-formula"):"",n=!!this.el&&this.el.attr("data-format"),r=this.el?this.el.val():null,i=this.el?this.el.prop("tagName").toLowerCase():"";if(t&&""!=$.trim(t)?t=t.toUpperCase():(t="CALX"+this.sheet.counter,this.el&&this.el.attr("data-cell",t),this.sheet.counter++),e=!(!e||""==$.trim(e))&&e.replace("&quot;",'"').replace("&#39;","'").replace("&#34;",'"'),"input"==i&&("checkbox"==this.el.attr("type")||"radio"==this.el.attr("type"))){var a=this.el.attr("data-unchecked");a=void 0===a?"":a,r=this.el.prop("checked")?this.el.val():a,this.isCheckbox=!0}if(this.el&&-1==this.formTags.indexOf(i)&&(r=this.el.text()),!1!==n&&void 0!==n||(n=this.sheet.config.defaultFormat),this.formula=e,this.format=n,this.address=t,n&&void 0!==numeral&&""!==$.trim(r)){var o=numeral().unformat(r);n.indexOf("%")>-1&&-1==r.indexOf("%")&&(o/=100)}else o=$.isNumeric(r)?parseFloat(r):r;this.setValue(o),""!=$.trim(r)&&$.isNumeric(r)&&this.renderComputedValue()},cell.fx.calculate=function(t,e){t=void 0===t||t,e=void 0===e||e,this.sheet.clearAffectedCell(),this.sheet.config.autoCalculate&&t&&"function"==typeof this.sheet.config.onBeforeCalculate&&this.sheet.config.onBeforeCalculate.call(this.sheet),calx.isCalculating=!0,this.evaluateFormula();for(var n in this.dependant)this.dependant[n].processDependant();for(var n in this.sheet.dependant)this.sheet.dependant[n].calculate(!1,!1);if(calx.isCalculating=!1,this.sheet.hasRelatedSheet())for(n in this.sheet.cells)this.sheet.cells[n].hasRemoteDependency()&&(this.sheet.cells[n].evaluateFormula(),this.sheet.cells[n].processDependant(),this.sheet.cells[n].renderComputedValue());return this.sheet.config.autoCalculate&&t&&"function"==typeof this.sheet.config.onAfterCalculate&&this.sheet.config.onAfterCalculate.call(this.sheet),this.sheet.config.autoCalculate&&t&&"function"==typeof this.sheet.config.onBeforeRender&&this.sheet.config.onBeforeRender.call(this.sheet),e&&this.renderComputedValue(),this.sheet.config.autoCalculate&&t&&"function"==typeof this.sheet.config.onAfterRender&&this.sheet.config.onAfterRender.call(this.sheet),this},cell.fx.buildDependency=function(){var t,e,n,r,i,a,o,l,u,s,c,f,h={remoteCellRange:/\#[A-Za-z0-9_]+\s*!\s*[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g,remoteCell:/\#[A-Za-z0-9_]+\s*!\s*[A-Za-z]+[0-9]+/g,cellRange:/[A-Za-z]+[0-9]+\s*:\s*[A-Za-z]+[0-9]+/g,cell:/[A-Z]+[0-9]+/g},d=this.formula,m="#"+this.sheet.el.attr("id"),g=this.address;for(e in this.dependencies)-1===e.indexOf("#")?this.dependencies[e].removeDependant(g):this.dependencies[e].removeDependant(m+"!"+g),delete this.dependencies[e];if(d)for(e in h)if(s=d.match(h[e]),d=d.replace(h[e],""),null!==s)switch(e){case"remoteCellRange":for(n=0;n<s.length;n++){a=s[n].split("!"),c=$.trim(a[0]),u=a[1].split(":"),o=$.trim(u[0]),l=$.trim(u[1]),t=this.sheet.getRemoteCellRange(c,o,l),void 0!==(f=$(c).attr("data-calx-identifier"))&&void 0!==calx.sheetRegistry[f]||($(c).calx(),f=$(c).attr("data-calx-identifier")),void 0!==f&&void 0!==calx.sheetRegistry[f]&&(calx.sheetRegistry[f].registerDependant(this.sheet),this.sheet.registerDependency(calx.sheetRegistry[f]));for(r in t)i=c+"!"+r,void 0===this.dependencies[i]&&!1!==t[r]&&(this.hasRemoteDependency(!0),this.dependencies[i]=t[r],t[r].registerDependant(m+"!"+this.getAddress(),this))}break;case"remoteCell":for(n=0;n<s.length;n++)a=s[n].split("!"),c=$.trim(a[0]),u=$.trim(a[1]),t=this.sheet.getRemoteCell(c,u),void 0!==(f=$(c).attr("data-calx-identifier"))&&void 0!==calx.sheetRegistry[f]||$(c).calx(),void 0!==f&&void 0!==calx.sheetRegistry[f]&&(calx.sheetRegistry[f].registerDependant(this.sheet),this.sheet.registerDependency(calx.sheetRegistry[f])),i=c+"!"+u,void 0===this.dependencies[i]&&!1!==t&&(this.hasRemoteDependency(!0),this.dependencies[i]=t,t.registerDependant(m+"!"+this.getAddress(),this));break;case"cellRange":for(n=0;n<s.length;n++){u=s[n].split(":"),o=$.trim(u[0]),l=$.trim(u[1]),t=this.sheet.getCellRange(o,l);for(r in t)void 0===this.dependencies[r]&&!1!==t[r]&&(this.dependencies[r]=t[r],t[r].registerDependant(this.getAddress(),this))}break;case"cell":for(n=0;n<s.length;n++)u=s[n],t=this.sheet.getCell(u),void 0===this.dependencies[u]&&!1!==t&&(this.dependencies[u]=t,t.registerDependant(this.getAddress(),this))}return this},cell.fx.removeDependency=function(t){void 0!==this.dependencies[t]&&delete this.dependencies[t]},cell.fx.processDependency=function(){if(0==this.isProcessed()){for(var t in this.dependencies)0==this.dependencies[t].isProcessed()&&this.dependencies[t].processDependency();this.evaluateFormula(),this.setProcessed(!0),-1==this.sheet.affectedCell.indexOf(this.address)&&this.sheet.affectedCell.push(this.address)}},cell.fx.registerDependant=function(t,e){void 0===this.dependant[t]&&e&&(this.dependant[t]=e)},cell.fx.removeDependant=function(t){void 0!==this.dependant[t]&&delete this.dependant[t]},cell.fx.processDependant=function(){var t;if(!1!==this.isProcessed()&&!0!==calx.isCalculating)return!1;this.processDependency();for(var e in this.dependant)if(!this.dependant[e].isProcessed()&&!1===(t=this.dependant[e].processDependant()))return t;this.setAffected(!1),this.setProcessed(!0),-1==this.sheet.affectedCell.indexOf(this.address)&&this.sheet.affectedCell.push(this.address)},cell.fx.hasRemoteDependency=function(t){if(void 0===t)return this.remoteDependency;this.remoteDependency=t},cell.fx.renderComputedValue=function(){if(this.formula&&"graph"==this.formula.substring(0,5).toLowerCase())return this;if(!1!==this.el){var t=this.el.prop("tagName").toLowerCase(),e=this.formTags.indexOf(t)>-1,n=this.formula?this.computedValue:this.value,r=""!=this.format&&void 0!==numeral&&""!==n&&!1!==n&&null!==n&&-1==data.ERROR.indexOf(n)&&$.isNumeric(n)?numeral(n).format(this.format):n;e?this.isCheckbox?this.el.prop("checked",n==this.el.val()):"select"==t?this.el.val(n):"input"!=t&&"textarea"!=t||this.el.val(r):this.el.html(r)}if("function"==typeof this.conditionalStyle){var i=this.conditionalStyle.apply(null,[this.getValue(),this.el]);"object"==typeof i&&this.el.css(i)}return this},cell.fx.resyncValue=function(){if(!1!==this.el){var t=this.el.prop("tagName").toLowerCase(),e=this.formTags.indexOf(t)>-1?this.el.val():this.el.text();this.isCheckbox&&!this.el.prop("checked")&&(e=this.el.attr("data-unchecked-value")||""),this.setValue(e)}},cell.fx.resyncFormula=function(){this.el&&this.el.attr("data-formula")!=this.formula&&(this.formula=this.el.attr("data-formula"),this.buildDependency())},cell.fx.checkCircularReference=function(t){var e,n=!1;if(void 0===t&&(t=this.getAddress()),!1!==this.formula){for(e in this.dependencies)if(n=n||e==t)return!0;for(e in this.dependencies)if(n=n||this.dependencies[e].checkCircularReference(t))return!0}return n},cell.fx.evaluateFormula=function(){if(this.formula)try{return this.sheet.setActiveCell(this),this.computedValue=this.sheet.evaluate(this.formula),this.computedValue}catch(t){return this.computedValue="#ERROR!",!1}return!1},cell.fx.formTags=["input","select","textarea","button"],cell.fx.setConditionalStyle=function(t){"function"==typeof t&&(this.conditionalStyle=t)},cell.fx.setFormat=function(t){return this.format=t,!1!==this.el&&(this.el.attr("data-format",t),this.renderComputedValue()),-1==this.sheet.affectedCell.indexOf(this.address)&&this.sheet.affectedCell.push(this.address),this},cell.fx.getFormat=function(){return this.format},cell.fx.setFormula=function(t){return"string"==typeof t&&(this.formula=t,!1!==this.el&&this.el.attr("data-formula",t),this.buildDependency(),-1==this.sheet.affectedCell.indexOf(this.address)&&this.sheet.affectedCell.push(this.address),this)},cell.fx.getFormula=function(){return this.formula},cell.fx.getAddress=function(){return this.address},cell.fx.getFormattedValue=function(){var t=this.formula?this.computedValue:this.value;return""!=this.format&&void 0!==numeral&&""!==t&&!1!==t&&null!==t&&-1==data.ERROR.indexOf(t)&&$.isNumeric(t)?numeral(t).format(this.format):t},cell.fx.setValue=function(t){return this.value=t,-1==this.sheet.affectedCell.indexOf(this.address)&&this.sheet.affectedCell.push(this.address),this},cell.fx.getValue=function(){return this.formula?this.computedValue:this.value},cell.fx.setAffected=function(t){return t=void 0===t||t,this.affected=t,this},cell.fx.isAffected=function(){return this.affected},cell.fx.setProcessed=function(t){return this.processed=void 0===t||t,this},cell.fx.isProcessed=function(){return this.processed},cell.fx.highlightDependant=function(){for(var t in this.dependant)this.dependant[t].el.css("border","solid 1px blue")},cell.fx.highlightDependency=function(){for(var t in this.dependencies)this.dependencies[t].el.css("border","solid 1px red")},sheet.fx=sheet.prototype,sheet.fx.init=function(){var t,e=this.el.find("[data-cell],[data-formula],[data-format]"),n=this;this.totalCell=e.length,this.parser=parserFactory(this),this.el.attr("data-calx-identifier",this.identifier),e.each(function(){t=new cell(n,this),n.registerCell(t)});for(var r in this.config.data)void 0===this.cells[r]&&(t=new cell(n,void 0,r),n.registerCell(t));n.attachEvent()},sheet.fx.checkCircularReference=function(){var t,e={isCircular:!1,cell:null};for(t in this.cells)if(e.isCircular=this.cells[t].checkCircularReference(),!0===e.isCircular)return e.cell=this.cells[t],e;return e},sheet.fx.clearProcessedFlag=function(){for(var t in this.cells)!1!==this.cells[t].formula?(this.cells[t].setProcessed(!1),this.cells[t].setAffected(!0)):(this.cells[t].setProcessed(!0),this.cells[t].setAffected(!1))},sheet.fx.buildCellDependency=function(){var t;for(t in this.cells)this.cells[t].buildDependency()},sheet.fx.renderComputedValue=function(){for(var t=0;t<this.affectedCell.length;t++)this.cells[this.affectedCell[t]].renderComputedValue();this.clearAffectedCell()},sheet.fx.clearAffectedCell=function(){this.affectedCell=[]},sheet.fx.hasRelatedSheet=function(){return this.relatedSheet},sheet.fx.clearCalculatedFlag=function(){var t;for(t in this.dependant)this.dependant[t].setCalculated(!1);for(t in this.dependencies)this.dependencies[t].setCalculated(!1)},sheet.fx.isCalculated=function(){return this.calculated},sheet.fx.setCalculated=function(t){t=void 0===t||t,this.calculated=t},sheet.fx.clearDependencies=function(){},sheet.fx.registerDependant=function(t){this.relatedSheet=!0,void 0===this.dependant[t.identifier]&&(this.dependant[t.identifier]=t)},sheet.fx.registerDependency=function(t){this.relatedSheet=!0,void 0===this.dependencies[t.identifier]&&(this.dependencies[t.identifier]=t)},sheet.fx.obj={type:"cell"},sheet.fx.comparator={greater:function(t,e){return t>e},greaterEqual:function(t,e){return t>=e},less:function(t,e){return t<e},lessEqual:function(t,e){return t<=e},equal:function(t,e){return t==e},notEqual:function(t,e){return t!=e}},sheet.fx.getVariable=function(t){var e=t[0],n=e.toUpperCase();return"TRUE"==n||"FALSE"!=n&&("NULL"==n?null:void 0===this.variables[e]?void 0===data.VARIABLE[e]?"#UNDEFINED_VARIABLE!":"function"==typeof data.VARIABLE[e]?data.VARIABLE[e].call(this):data.VARIABLE[e]:"function"==typeof this.variables[e]?this.variables[e].call(this):this.variables[e])},sheet.fx.time=function(t){var e=t.split(":"),n=new Date,r=void 0===e[0]?0:e[0],i=void 0===e[1]?0:e[1],a=void 0===e[2]?0:e[2];return new Date(n.getFullYear(),n.getMonth(),n.getDate(),r,i,a)},sheet.fx.callFunction=function(t,e){var n,r;if(r=t.toUpperCase(),"function"==typeof formula[r])return formula[r].apply(this,e);for(n in formula)if("function"==typeof formula[n][r])return formula[n][r].apply(this,e);return"#NAME?"},sheet.fx.getRemoteCell=function(t,e){var n=$(t).attr("data-calx-identifier");return!(!n||void 0===calx.sheetRegistry[n])&&calx.sheetRegistry[n].getCell(e)},sheet.fx.getRemoteCellRange=function(t,e,n){var r=$(t).attr("data-calx-identifier");return!(!r||void 0===calx.sheetRegistry[r])&&calx.sheetRegistry[r].getCellRange(e,n)},sheet.fx.getRemoteCellValue=function(t,e){var n=$(t).attr("data-calx-identifier");return!(!n||void 0===calx.sheetRegistry[n])&&calx.sheetRegistry[n].getCellValue(e)},sheet.fx.getRemoteCellRangeValue=function(t,e,n){var r=$(t).attr("data-calx-identifier");return!(!r||void 0===calx.sheetRegistry[r])&&calx.sheetRegistry[r].getCellRangeValue(e,n)},sheet.fx.getCellRangeValue=function(t,e){t=t.toUpperCase(),e=e.toUpperCase();var n,r=utility.cellRange(t,e),i=r.length,a={};for(n=0;n<i;n++)a[r[n]]=this.getCellValue(r[n]);return a},sheet.fx.getCellValue=function(t){var e=t.toUpperCase();return void 0!==this.cells[e]&&this.cells[e].getValue()},sheet.fx.evaluate=function(t){return this.parser.parse(t)},sheet.fx.update=function(){var t,e=this.el.find("[data-cell],[data-formula],[data-format]"),n=this;this.totalCell=e.length;for(var r in this.cells)this.cells[r].el&&!$.contains(document,this.cells[r].el[0])&&delete this.cells[r];e.each(function(){var e=$(this).attr("data-cell");e&&void 0===n.cells[e]?(t=new cell(n,this),n.registerCell(t)):(n.cells[e].resyncValue(),n.cells[e].resyncFormula())}),this.buildCellDependency()},sheet.fx.calculate=function(){var t;this.clearAffectedCell(),"function"==typeof this.config.onBeforeCalculate&&this.config.onBeforeCalculate.call(this),this.calculateDependency(this.identifier),this.clearProcessedFlag();for(t in this.cells)this.cells[t].processDependency();this.setCalculated();for(t in this.cells)this.cells[t].hasRemoteDependency()&&this.cells[t].evaluateFormula();return this.calculateDependant(this.identifier),"function"==typeof this.config.onAfterCalculate&&this.config.onAfterCalculate.call(this),"function"==typeof this.config.onBeforeRender&&this.config.onBeforeRender.call(this),this.renderComputedValue(),"function"==typeof this.config.onAfterRender&&this.config.onAfterRender.call(this),this},sheet.fx.calculateDependant=function(t){},sheet.fx.calculateDependency=function(t){},sheet.fx.registerCell=function(t){var e=t.getAddress();if(this.cells[e]=t,void 0!==this.config.data[e]){var n=this.config.data[e];void 0!==n.value&&(t.setValue(n.value),t.renderComputedValue()),void 0!==n.format&&t.setFormat(n.format),void 0!==n.formula&&t.setFormula(n.formula),void 0!==n.conditional_style&&t.setConditionalStyle(n.conditional_style)}-1==this.affectedCell.indexOf(t.getAddress())&&this.affectedCell.push(t.getAddress())},sheet.fx.registerVariable=function(t,e){if("object"==typeof t)for(var n in t)this.variables[n]=t[n];else this.variables[t]=e},sheet.fx.getCell=function(t){return t=t.toUpperCase(),void 0!==this.cells[t]&&this.cells[t]},sheet.fx.getCellRange=function(t,e){t=t.toUpperCase(),e=e.toUpperCase();var n,r=utility.cellRange(t,e),i=r.length,a={};for(n=0;n<i;n++)a[r[n]]=this.getCell(r[n]);return a},sheet.fx.applyChange=function(){var t;for(t in this.cells)this.cells[t].processDependency(!1,!1);for(t in this.cells)this.cells[t].renderComputedValue();return this},sheet.fx.scan=function(){},sheet.fx.refresh=function(){var t,e=this.el.find("[data-cell],[data-formula],[data-format]"),n=this;this.totalCell=e.length,this.cells={},e.each(function(){t=new cell(n,this),n.registerCell(t)}),this.buildCellDependency()},sheet.fx.reset=function(){("form"==this.el.prop("tagName").toLowerCase()?this.el:this.el.find("form")).each(function(){this.reset()});for(var t in this.cells)this.cells[t].resyncValue();this.calculate()},sheet.fx.setActiveCell=function(t){this.activeCell=t},sheet.fx.getActiveCell=function(){return this.activeCell},sheet.fx.attachEvent=function(){var t=this;this.el.on("calx.getValue","input[data-cell]",function(){var e=$(this).attr("data-cell"),n=t.cells[e],r=n.getValue(),i=n.getFormat();i&&i.indexOf("%")>=0&&(r=100*r+" %"),n.isCheckbox||n.el.val(r)}),this.el.on("calx.renderComputedValue","input[data-cell]",function(){var e=$(this).attr("data-cell");t.cells[e].renderComputedValue()}),this.el.on("calx.setValue","input[data-cell], select[data-cell]",function(){var e=$(this).attr("data-cell"),n=t.cells[e],r=n.getValue(),i=n.el.val(),a=n.getFormat();if(n.isCheckbox&&"checkbox"==n.el.attr("type"))if(n.el.prop("checked"))n.setValue(i);else{var o=n.el.attr("data-unchecked");i=o=void 0===o?"":o,n.setValue(o)}else n.isCheckbox&&"radio"==n.el.attr("type")?(n.setValue(i),t.el.find("[name="+n.el.attr("name")+"]").not(n.el).each(function(){var e=$(this),n=e.attr("data-unchecked"),r=e.attr("data-cell");n=void 0===n?"":n,t.cells[r].setValue(n)})):(a&&void 0!==numeral&&""!==$.trim(i)?(rawValue=numeral().unformat(i),a.indexOf("%")>-1&&-1==i.indexOf("%")&&(rawValue/=100)):rawValue=$.isNumeric(i)?parseFloat(i):i,n.setValue(rawValue));r!=i&&n.setAffected(!0)}),this.el.on("calx.calculateSheet","input[data-cell]",function(){t.calculate()}),this.el.on("calx.calculateCellDependant","input[data-cell], select[data-cell]",function(){var e=$(this).attr("data-cell"),n=t.cells[e];n.isAffected()&&(!0===calx.isCalculating&&(calx.isCalculating=!1),t.clearProcessedFlag(),n.calculate(!0,!1),t.hasRelatedSheet()?t.calculate():t.renderComputedValue())}),this.el.on(t.config.autoCalculateTrigger,"input[data-cell]",function(){var e=$(this);e.attr("data-formula")||t.config.autoCalculate&&setTimeout(function(){e.trigger("calx.calculateCellDependant")},50)}),this.el.on("blur","input[data-cell]",function(){$(this).trigger("calx.renderComputedValue")}),this.el.on("change","select[data-cell]",function(){$(this).trigger("calx.setValue"),t.config.autoCalculate&&$(this).trigger("calx.calculateCellDependant")}),this.el.on("click","input[data-cell][type=checkbox], input[data-cell][type=radio]",function(){$(this).trigger("calx.setValue"),t.config.autoCalculate&&$(this).trigger("calx.calculateCellDependant")}),this.el.on("focus","input[data-cell]",function(){$(this).trigger("calx.getValue")}),this.el.on("keyup","input[data-cell]",function(t){if($(this).attr("data-formula"))return t.preventDefault(),!1;$(this).trigger("calx.setValue")})},sheet.fx.detachEvent=function(){this.el.off("calx.getValue"),this.el.off("calx.setValue"),this.el.off("calx.renderComputedValue"),this.el.off("calx.calculateSheet"),this.el.off("calx.calculateCellDependant")};var calx={isCalculating:!1,version:"2.2.7",sheetRegistry:{},init:function(t){var e;this.each(function(){(e=$(this).attr("data-calx-identifier"))&&void 0!==calx.sheetRegistry[e]?calx.sheetRegistry[e].refresh():(e="CALX"+(new Date).valueOf(),calx.sheetRegistry[e]=new sheet(e,this,t))});for(e in calx.sheetRegistry)calx.sheetRegistry[e].buildCellDependency();for(e in calx.sheetRegistry){if(calx.sheetRegistry[e].config.checkCircularReference){var n=calx.sheetRegistry[e].checkCircularReference();if(n.isCircular){var r="Circular reference detected, this may cause calx to stop working.\ncell : "+n.cell.getAddress()+"\nformula : "+n.cell.getFormula()+"\n\nPlease check each cells involved in the formula that has direct or indirect reference to "+n.cell.getAddress();alert(r),$.error(r)}}calx.sheetRegistry[e].config.autoCalculate&&calx.sheetRegistry[e].calculate(),calx.sheetRegistry[e].renderComputedValue()}return this},registerFunction:function(t,e,n){if(n=void 0!==n&&n)for(var r in formula)void 0!==formula[r][t]&&delete formula[r][t];formula.user_defined[t]=e},registerVariable:function(t,e,n){if(n=void 0!==n&&n,0===this.length&&(n=!0),n)if("object"==typeof t)for(var r in t)data.VARIABLE[r]=t[r];else data.VARIABLE[t]=e;else this.each(function(){var n=$(this).attr("data-calx-identifier");n&&void 0!==calx.sheetRegistry[n]&&(calx.sheetRegistry[n].registerVariable(t,e),calx.sheetRegistry[n].calculate())});return this},refresh:function(){return this.each(function(){var t=$(this).attr("data-calx-identifier");t&&void 0!==calx.sheetRegistry[t]&&calx.sheetRegistry[t].refresh()})},update:function(){return this.each(function(){var t=$(this).attr("data-calx-identifier");t&&void 0!==calx.sheetRegistry[t]&&calx.sheetRegistry[t].update()})},getSheet:function(){var t=$(this).attr("data-calx-identifier");return void 0!==calx.sheetRegistry[t]&&calx.sheetRegistry[t]},getCell:function(t){var e=$(this).attr("data-calx-identifier");return calx.sheetRegistry[e].getCell(t)},getUtility:function(){return utility},getFormula:function(){return formula},evaluate:function(t){var e=$(this).attr("data-calx-identifier");return calx.sheetRegistry[e].evaluate(t)},destroy:function(){return this.each(function(){var t=$(this),e=t.attr("data-calx-identifier");t.removeAttr("data-calx-identifier"),void 0!==calx.sheetRegistry[e]&&(calx.sheetRegistry[e].detachEvent(),calx.sheetRegistry[e].clearDependencies(),delete calx.sheetRegistry[e])}),this},reset:function(){return this.each(function(){var t=$(this).attr("data-calx-identifier");t&&void 0!==calx.sheetRegistry[t]&&calx.sheetRegistry[t].reset()})},calculate:function(){return this.each(function(){var t=$(this).attr("data-calx-identifier");t&&void 0!==calx.sheetRegistry[t]&&calx.sheetRegistry[t].calculate()})},setValue:function(t,e){var n=$(this).attr("data-calx-identifier"),r=calx.sheetRegistry[n];r.getCell(t).setValue(e).renderComputedValue(),r.config.autoCalculate&&r.calculate()}};$.fn.calx=function(t,e){return calx[t]?calx[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof t||void 0===t?calx.init.apply(this,arguments):void $.error("Method "+t+" does not exist on jQuery.calx")}}(jQuery,numeral,moment,jStat);
